<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="KNOW-HOW">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="KNOW-HOW">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Guo">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>KNOW-HOW</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">KNOW-HOW</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Guo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">190</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">236</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/raytroop" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;raytroop" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:raytroop@gmail.com" title="E-Mail â†’ mailto:raytroop@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/07/01/github-pages-deploy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/07/01/github-pages-deploy/" class="post-title-link" itemprop="url">GitHub Pages Build and deployment</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-07-01 14:21:49" itemprop="dateCreated datePublished" datetime="2023-07-01T14:21:49+00:00">2023-07-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:21" itemprop="dateModified" datetime="2023-09-24T16:23:21+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/devops/" itemprop="url" rel="index"><span itemprop="name">devops</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>The repository visibility shall be <code>public</code></p>
<p><img
src="/2023/07/01/github-pages-deploy/image-20230701142405404.png"
alt="image-20230701142405404" /></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/06/22/leakage-mos/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/06/22/leakage-mos/" class="post-title-link" itemprop="url">Leakage in MOS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-06-22 01:41:31" itemprop="dateCreated datePublished" datetime="2023-06-22T01:41:31+00:00">2023-06-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:21" itemprop="dateModified" datetime="2023-09-24T16:23:21+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="/2023/06/22/leakage-mos/image-20230812104737404.png"
alt="image-20230812104737404" /></p>
<h2 id="reference">reference</h2>
<p>W. M. Elgharbawy and M. A. Bayoumi, "Leakage sources and possible
solutions in nanometer CMOS technologies," in IEEE Circuits and Systems
Magazine, vol. 5, no. 4, pp. 6-17, Fourth Quarter 2005, doi:
10.1109/MCAS.2005.1550165.</p>
<p>X. Qi et al., "Efficient subthreshold leakage current optimization -
Leakage current optimization and layout migration for 90- and 65- nm
ASIC libraries," in IEEE Circuits and Devices Magazine, vol. 22, no. 5,
pp. 39-47, Sept.-Oct. 2006, doi: 10.1109/MCD.2006.272999.</p>
<p>P. MonsurrÃ³, S. Pennisi, G. Scotti and A. Trifiletti, "Exploiting the
Body of MOS Devices for High Performance Analog Design," in IEEE
Circuits and Systems Magazine, vol. 11, no. 4, pp. 8-23, Fourthquarter
2011, doi: 10.1109/MCAS.2011.942751.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/06/18/math-and-noise/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/06/18/math-and-noise/" class="post-title-link" itemprop="url">Applied Mathematics and Noise</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-06-18 21:10:55" itemprop="dateCreated datePublished" datetime="2023-06-18T21:10:55+00:00">2023-06-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:21" itemprop="dateModified" datetime="2023-09-24T16:23:21+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><em>This is a summary and overview, not original work. Most
derivations etc. are based on those in the references; any mistakes are
my own.</em></p>
<h1 id="a-long-way-to-go">a long way to go</h1>
<p>ðŸ’¢ random process</p>
<p>ðŸ’¢ sde</p>
<hr />
<p>In applying frequency-domain techniques to the analysis of random
signals the natural approach is to Fourier transform the signals.</p>
<p>Unfortunately the Fourier transform of a stochastic process does not,
strictly speaking, exist because it has infinite signal energy.</p>
<h1 id="phase-noise-model">Phase Noise Model</h1>
<p>Consider a stable periodic oscillator subjected to random
fluctuations, so that is satisfies a vector Ito stochastic differential
equation of the form</p>
<p><span class="math display">\[
dX = \mathbf{f(X)}dt + G(X)dW
\]</span></p>
<h2 id="general-model">General Model</h2>
<p>Two assumptions:</p>
<ul>
<li><p>random trajectory perturbations in directions tangent to the
isochron surface passing through <span
class="math inline">\(X(t)\)</span> will never accumulate</p></li>
<li><p>random fluctuations in the direction of the tangent to the stable
orbit accumulate</p></li>
</ul>
<p>This suggests therefore the approximation</p>
<p><span class="math display">\[
X(t) \simeq \mathbf{x}_c(t+\alpha(t)) + \mathbf{\Delta}(t)
\]</span></p>
<p>where <span class="math inline">\(\mathbf{\Delta}(t)\)</span>
represents a small perturbation belonging to the tangent space to the
isochron surface pass through <span
class="math inline">\(\mathbf{x}_c(t+\alpha(t))\)</span></p>
<p>If <span class="math inline">\(\phi(X(t))\)</span> is the asymptotic
phase corresponding to trajectory point <span
class="math inline">\(X(t)\)</span>, the <strong>phase
noise</strong></p>
<p><span class="math display">\[
\alpha(t) = \phi(X(t)) - t
\]</span></p>
<p>After rigorous Ito's process, it can be proven that the phase noise
<span class="math inline">\(\alpha(t)\)</span> satisfies the scalar Ito
stochastic differential equation</p>
<p><span class="math display">\[
d\alpha(t) =
\mathbf{q}_1^T(t+\alpha(t))G(\mathbf{x}_c(t+\alpha(t)))dW(t)
\]</span></p>
<p>The equation models the <em>unwrapped</em> phase noise <span
class="math inline">\(\alpha(t)\)</span>, which takes values in <span
class="math inline">\(\mathbb{R}\)</span></p>
<blockquote>
<p><span class="math inline">\(d\alpha(t) =
\mathbf{q}_1^T(t+\alpha(t))G(\mathbf{x}_c(t+\alpha(t)))dW(t)\)</span>
can be seen as the perturbation <span
class="math inline">\(G(\mathbf{x}_c(t+\alpha(t)))dW(t)\)</span>
projected onto phase gradient <span
class="math inline">\(\mathbf{q}_1\)</span></p>
</blockquote>
<h1 id="mathematical-background">mathematical background</h1>
<h2 id="linear-systems-of-odes">Linear systems of ODEs</h2>
<h3 id="exact-equations">Exact equations</h3>
<p>Suppose <span class="math inline">\(F(x; y)\)</span> is a function of
two variables, which we call the <strong>potential function</strong>,
which suggest potential energy, or electric potential (<span
class="math inline">\(F(x; y) = C\)</span>).</p>
<p>We take the <em>total derivative</em> of <span
class="math inline">\(F\)</span>: <span class="math display">\[
dF = \frac{\partial F}{\partial x}dx +\frac{\partial F}{\partial y}dy
\]</span> We apply the total derivative to <span
class="math inline">\(F(x; y) = C\)</span>, to find the differential
equation <span class="math inline">\(dF=0\)</span></p>
<p>An equation of the form <span class="math display">\[
M(x,y)+N(x,y)\frac{dy}{dx}=0
\]</span> is called <strong>exact</strong> if it was obtained as <span
class="math inline">\(dF = 0\)</span> for some <em>potential
function</em> <span class="math inline">\(F\)</span></p>
<h3 id="integrating-factor">integrating factor</h3>
<p>Given a linear first order equation: <span class="math display">\[
y&#39;+p(x)y = f(x)
\]</span> The <strong>integrating factor</strong> is defined as <span
class="math display">\[
r(x) = e^{\int p(x)dx}
\]</span> We multiply the above linear first order equation with <span
class="math inline">\(r(x)\)</span> <span
class="math display">\[\begin{align}
y&#39;+p(x)y &amp;= f(x) \\
e^{\int p(x)dx}y&#39;+e^{\int p(x)dx}p(x)y &amp;=e^{\int p(x)dx}f(x) \\
\frac{d}{dx}\left[e^{\int p(x)dx}y\right] &amp;=e^{\int p(x)dx}f(x) \\
e^{\int p(x)dx}y &amp;= \int e^{\int p(x)dx}f(x)dx + C \\
y &amp;= e^{-\int p(x)dx}\left(  \int e^{\int p(x)dx}f(x)dx + C \right)
\end{align}\]</span></p>
<blockquote>
<p>Of course, to get a closed form formula for <span
class="math inline">\(y\)</span>, we need to be able to find a closed
form formula for the integrals appearing above</p>
</blockquote>
<h2 id="nonlinear-autonomous-systems-of-odes">Nonlinear Autonomous
Systems of ODEs</h2>
<p>We restrict our attention to a two-dimensional autonomous system
<span class="math display">\[\begin{align}
x&#39; &amp;= f(x,y) \\
y&#39; &amp;= g(x,y)
\end{align}\]</span></p>
<p>where <span class="math inline">\(f(x,y)\)</span> and <span
class="math inline">\(g(x,y)\)</span> are functions of two variables,
and the derivatives are taken with respect to time <span
class="math inline">\(t\)</span></p>
<h3 id="critical-points">critical points</h3>
<p><strong>critical points</strong> are the points where both <span
class="math inline">\(f(x; y) = 0\)</span> and <span
class="math inline">\(g(x; y) = 0\)</span></p>
<h3 id="linearization">Linearization</h3>
<p>we want to linearize the two functions <span
class="math inline">\(f(x; y)\)</span> and <span
class="math inline">\(g(x; y)\)</span> that define this system. To do
so, we will replace <span class="math inline">\(f\)</span> and <span
class="math inline">\(g\)</span> by the <em>tangent plane</em>
approximation to the functions.</p>
<p>Since <span class="math inline">\((x_0; y_0)\)</span> is a critical
point, we know that <span class="math inline">\(f(x_0; y_0) =
0\)</span>, so the tangent plane is given by <span
class="math display">\[
L_f(x; y) = f_x(x_0; y_0)(x âˆ’ x_0) + f_y(x_0; y_0)(y âˆ’ y_0)
\]</span> Similarly, the tangent plane for <span
class="math inline">\(g(x; y)\)</span> near the critical point <span
class="math inline">\((x_0; y_0)\)</span> is given by <span
class="math display">\[
L_g(x; y) = g_x(x_0; y_0)(x âˆ’ x_0) + g_y(x_0; y_0)(y âˆ’ y_0)
\]</span> That means that we can <em>approximate</em> the solution to
<span class="math inline">\(x&#39; = f(x,y);\quad y&#39; =
g(x,y)\)</span> near the critical point <span
class="math inline">\((x_0, y_0)\)</span> <em>by</em> the solution to
the system <span class="math display">\[\begin{align}
\frac{dx}{dt} &amp;= f_x(x_0, y_0)(x âˆ’ x_0) + f_y(x_0, y_0)(y âˆ’ y_0) \\
\frac{dy}{dt} &amp;= g_x(x_0, y_0)(x âˆ’ x_0) + g_y(x_0, y_0)(y âˆ’ y_0)
\end{align}\]</span></p>
<p>Next, change variables to <span class="math inline">\((u,v)\)</span>.
That is <span class="math inline">\(u=x-x_0; \quad v=y-y_0\)</span>, so
that <span class="math inline">\((u,v)=(0,0)\)</span> corresponds to
<span class="math inline">\((x_0, y_0)\)</span></p>
<blockquote>
<p>Notice changing variables is not going to affect our differential
equations because <span class="math inline">\(x_0\)</span> and <span
class="math inline">\(y_0\)</span> are constant. <span
class="math display">\[\begin{align}
\frac{dx}{dt} &amp;= \frac{du}{dt} \\
\frac{dy}{dt} &amp;= \frac{dv}{dt}
\end{align}\]</span></p>
</blockquote>
<p>The <em>linearization</em> as the linear system <span
class="math display">\[
\begin{bmatrix}
u \\
v
\end{bmatrix}&#39;
=
\begin{bmatrix}
\frac{\partial f}{\partial x}(x_0,y_0) &amp; \frac{\partial f}{\partial
y}(x_0,y_0) \\
\frac{\partial g}{\partial x}(x_0,y_0) &amp; \frac{\partial g}{\partial
y}(x_0,y_0)
\end{bmatrix}
\begin{bmatrix}
u \\
v
\end{bmatrix}
\]</span></p>
<blockquote>
<p><strong>Jacobian matrix</strong>: derivative matrix</p>
</blockquote>
<h3 id="conservative-equations">Conservative equations</h3>
<p>An equation of the form <span class="math display">\[
x&#39;&#39; + f(x)=0
\]</span> for an arbitrary function <span
class="math inline">\(f(x)\)</span> is called a <strong>conservative
equation</strong></p>
<blockquote>
<p>The equations are conservative as there is no friction in the system
so the energy in the system is "conserved".</p>
</blockquote>
<p>Let us write this equation as a system of nonlinear ODE <span
class="math display">\[
x&#39; = y, \quad y&#39; = -f(x)
\]</span></p>
<p>Assume that we have an <em>autonomous system</em> of differential
equations defining <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span>, <span class="math display">\[
x&#39; = f(x,y), \quad y&#39; = g(x,y)
\]</span> A <strong>trajectory</strong> for this system is a curve in
the <span class="math inline">\(xy\)</span>-plane that the solution
curve <span class="math inline">\((x(t); y(t))\)</span> will <em>stay
on</em> for <strong>all</strong> <span
class="math inline">\(t\)</span>.</p>
<blockquote>
<p>This curve will generally be given with</p>
<ul>
<li><span class="math inline">\(y\)</span> as a function of <span
class="math inline">\(x\)</span>,</li>
<li>or the level curve of some function <span class="math inline">\(F(x;
y)\)</span>.</li>
</ul>
</blockquote>
<h3 id="hamiltonian-systems">Hamiltonian Systems</h3>
<p>A generalization of <em>conservative equations</em> to systems is a
<strong>Hamiltonian system</strong>.</p>
<p>For these systems, the point is that the equation has a <em>conserved
quantity</em> called a <strong>Hamiltonian</strong>, which <em>does not
change as the system evolves in time</em>, which generally represents
the <em>energy of the system</em>. Calling this function <span
class="math inline">\(H(x; y)\)</span>, this means that <span
class="math display">\[
\frac{d}{dt}H(x,y) = 0
\]</span> Below give the definition of <strong>Hamiltonian
system</strong>:</p>
<blockquote>
<p>The system <span class="math display">\[\begin{align}
\frac{dx}{dt} &amp;= f(x,y) \\
\frac{dy}{dt} &amp;= g(x, y)
\end{align}\]</span></p>
<p>is <strong>Hamiltonian</strong> if there is a function <span
class="math inline">\(H(x,y)\)</span> so that <span
class="math display">\[\begin{align}
f(x,y) &amp;=-\frac{\partial H}{\partial y} \\
g(x,y) &amp;= \frac{\partial H}{\partial x}
\end{align}\]</span></p>
</blockquote>
<h3 id="limit-cycles">Limit cycles</h3>
<p>unforced nonlinear time-invariant differential systems of the form
<span class="math display">\[
\frac{d\mathbf{x}}{dt}=\mathbf{f(x)}
\]</span></p>
<p>For nonlinear systems, trajectories do not simply need to approach or
leave a single point. They may in fact approach a larger set, such as a
<em>circle</em> or <em>another closed curve</em>.</p>
<h4 id="poincarÃ©bendixson-theorem">PoincarÃ©â€“Bendixson Theorem</h4>
<h3 id="floquet-theory">Floquet Theory</h3>
<p>When a small perturbation <span
class="math inline">\(\mathbf{\delta}(t)\)</span> is applied to a
periodic orbit <span class="math inline">\(\mathbf{x}_c(t)\)</span> so
that the oscillator position is <span class="math display">\[
\mathbf{x}(t)=\mathbf{x}_c(t)+\mathbf{\delta}(t)
\]</span> by performing a Taylor series expansion in the vicinity of
<span class="math inline">\(\mathbf{x}_c(t)\)</span>, we obtain</p>
<p><span class="math display">\[\begin{align}
\frac{d}{dt}(\mathbf{x}_c(t)+\mathbf{\delta}(t)) &amp;=
\mathbf{f}(\mathbf{x}_c(t)+\mathbf{\delta}(t)) \\
&amp;= \mathbf{f}(\mathbf{x}_c(t)) + \mathbf{A}(t)\mathbf{\delta}(t) +
O(||\mathbf{\delta}(t)||^2)
\end{align}\]</span></p>
<p>where <span class="math display">\[
\mathbf{A}(t) = \mathbf{J}(\mathbf{x}_c(t))
\]</span> denotes the vector field Jacobian evaluted along the periodic
orbit <span class="math inline">\(\mathbf{x}_c(t)\)</span></p>
<p>This indicates that small trajectory perturbations satisfy the linear
differential equation <span class="math display">\[
\frac{d\mathbf{\delta}}{dt} = \mathbf{A}(t)\mathbf{\delta}(t)
\]</span></p>
<blockquote>
<p>where <span class="math inline">\(\mathbf{A}(t)\)</span> is periodic
with period <span class="math inline">\(T\)</span> since <span
class="math inline">\(\mathbf{x}_c(t)\)</span> is periodic with the same
period</p>
</blockquote>
<p>Since <span class="math inline">\(\mathbf{x}_c(t)\)</span> solves the
differential equation, by differentiating <span class="math display">\[
\frac{d\mathbf{x}_c(t)}{dt} =\mathbf{f}(\mathbf{x}_c(t)
\]</span> we obtain <span class="math display">\[
\frac{d}{dt}\left(\frac{d\mathbf{x}_c(t)}{dt}\right)
=\frac{d\mathbf{f}}{d\mathbf{x}_c}\frac{d\mathbf{x}_c(t)}{dt}
\]</span> and denoting <span
class="math inline">\(\mathbf{v}(t)=d\mathbf{x}_c/dt\)</span>, then
<span class="math display">\[
\frac{d\mathbf{v}}{dt} = \mathbf{A}(t)\mathbf{v}(t)
\]</span> where the velocity vector <span
class="math inline">\(\mathbf{v}(t)\)</span> is periodic with period
<span class="math inline">\(T\)</span> and is tangent to orbit <span
class="math inline">\(C\)</span> at point <span
class="math inline">\(\mathbf{x}_c(t)\)</span></p>
<blockquote>
<p><strong>SPECIAL CASE:</strong></p>
<p>If the initial perturbation <span
class="math inline">\(\mathbf{\delta}(0)\)</span> is colinear with
vector <span class="math inline">\(\mathbf{v}(0)\)</span>, i.e., <span
class="math inline">\(\mathbf{\delta}(0) = \alpha
\mathbf{v}(0)\)</span>, then <span class="math display">\[
\mathbf{\delta}(t) = \alpha \mathbf{v}(t)
\]</span> for all <span class="math inline">\(t\)</span>, so that in
this case <span class="math inline">\(\mathbf{\delta}(t)\)</span>
<strong>remain</strong> colinear with <span
class="math inline">\(\mathbf{v}(t)\)</span> and is periodic with period
<span class="math inline">\(T\)</span></p>
</blockquote>
<p>Since the oscillator orbit we consider is stable, small perturbations
in <strong>directions other than the tangent to the trajectory</strong>
must <strong>disappear</strong> as <span
class="math inline">\(t\)</span> becomes large.</p>
<p>i.e., if <span class="math inline">\(\mathbf{\delta}(0)\)</span> has
no component along the <span
class="math inline">\(\mathbf{v}(0)\)</span> direction, we must have
<span class="math display">\[
\lim_{t\to \infty}\mathbf{\delta}(t) = 0
\]</span></p>
<h3 id="chaos">Chaos</h3>
<p>Achaotic system is extremely sensitive to initial conditions.</p>
<p>A small change in the initial conditions yields a very different
solution after a reasonably short time</p>
<h2 id="riemann-integral">Riemann integral</h2>
<p><em>standard</em> (Riemann) integral <span class="math display">\[
\int_0^T f(t)dt = \lim_{N\to\infty}\sum_{k=0}^{N-1}f(\tilde{t_k})\Delta
t_k,\quad\Delta t_k=t_{k+1}-t_k
\]</span> where the width of each interval is <span
class="math inline">\(T/N\)</span>, and for each interval <span
class="math inline">\(\Delta t_k\)</span>, we choose a value <span
class="math inline">\(\tilde{t_k}\in[t_k,t_{k+1}]\)</span> at which we
evaluate the function.</p>
<p><img src="/2023/06/18/math-and-noise/riemann_int.png"
alt="The Riemann integral construction; divide the function up into rectangles. Here, Iâ€™ve evaluated the function at the left edge of each rectangle." /></p>
<p>The Riemann integral construction; divide the function up into
rectangles. Here, Iâ€™ve evaluated the function at the <em>left edge</em>
of each rectangle.</p>
<blockquote>
<p>For <em>ordinary, smooth functions</em>, of course, this integral
converges to the same value <em>no matter</em> where we choose our
rectangle heights <span class="math inline">\(\tilde{t_k}\)</span> in
the interval.</p>
<p>However, Brownian motion is <em>less well behaved</em>.</p>
</blockquote>
<h2 id="lebesgue-integral">Lebesgue integral</h2>
<p>[<a target="_blank" rel="noopener" href="https://qr.ae/py5x6K">What is the difference between a
Riemann and a Lebesgue integral, and why is the latter needed?</a>]</p>
<p>Riemann integration:</p>
<p><img src="/2023/06/18/math-and-noise/image-20230702004840807.png"
alt="image-20230702004840807" /></p>
<blockquote>
<p>The disadvantage of the Riemann integral is that it privileges the
role of intervals. It is ineffective when applied to a highly
discontinuous function</p>
</blockquote>
<p>Lebesgue integration:</p>
<p><img src="/2023/06/18/math-and-noise/image-20230702005049938.png"
alt="image-20230702005049938" /></p>
<h2 id="measure-and-probabilities">Measure and Probabilities</h2>
<blockquote>
<p>Probality is a measure of the size of a set</p>
</blockquote>
<h3 id="power-set">power set</h3>
<h3 id="sigma-algebra"><span
class="math inline">\(\sigma\)</span>-Algebra</h3>
<p>or <span class="math inline">\(\sigma\)</span>-field, Sigma-field</p>
<h3 id="measurable-space">measurable space</h3>
<p>If <span class="math inline">\(X\)</span> is a set and <span
class="math inline">\(A\)</span> is a <span
class="math inline">\(\sigma\)</span>-algebra on <span
class="math inline">\(X\)</span>, then the tuple <span
class="math inline">\((X,A)\)</span> is called the <strong>measurable
space</strong> (also <strong>Borel space</strong>)</p>
<h3 id="probability-space">probability space</h3>
<h3 id="filtration-and-information-flow">filtration and information
flow</h3>
<h3 id="martingale">martingale</h3>
<p>A stochastic process <span class="math inline">\(M_t\)</span> is a
<strong>martingale</strong> if</p>
<ul>
<li><p>its <em>mean</em> is bounded</p></li>
<li><p>and <em>the conditional expectation given access to itâ€™s history
up to time</em> <span class="math inline">\(t&#39;\)</span> is equal to
the value at that time</p></li>
</ul>
<p>that is <span class="math display">\[\begin{align}
\mathbb{E}[|M_t|] &amp;\lt \infty \\
\mathbb{E}[M_t|{M_s,s\leq t&#39;}] &amp;= M_{t&#39;}, \quad \text{for
all } t&#39;\leq t
\end{align}\]</span></p>
<blockquote>
<p>In less formal language, this means that the â€œbest guess" for the
future value of a martingale is always the most recent observed value;
knowing <span class="math inline">\(M_{t&#39;}\)</span> is just as good
as knowing the entire history of <span
class="math inline">\(M_t\)</span> up to <span
class="math inline">\(t&#39;\)</span></p>
<p>If <span class="math inline">\(W_t\)</span> is your wealth at the
<span class="math inline">\(t^{th}\)</span> round of a fair game, like
betting on a coin flip, then <span class="math inline">\(W_t\)</span> is
a martingale; on average you end up with the same amount of money you
started with.</p>
</blockquote>
<h3 id="wss-process">WSS process</h3>
<p>A random process <span class="math inline">\(X(t)\)</span> is
<strong>wide-sense stationary</strong> if:</p>
<ol type="1">
<li><span class="math inline">\(\mu _x(t)=\text{constant}\)</span>, for
all <span class="math inline">\(t\)</span>, and</li>
<li><span class="math inline">\(R_X(t_1, t_2)=R_x(t_1-t_2)\)</span> for
all <span class="math inline">\(t_1, t_2\)</span></li>
</ol>
<h4 id="autocorrelation">autocorrelation</h4>
<p><span class="math display">\[
R_X(t_1, t_2) = \mathbb{E}[X(t_1)X(t_2)]
\]</span></p>
<h4 id="temporal-average">temporal average</h4>
<p>Consider the following function: <span class="math display">\[
\hat{R_X}(\tau) = \frac{1}{2T}\int_{-T}^{T}X(t+\tau)X(t)dt
\]</span> This function is the temporal average of <span
class="math inline">\(X(t+\tau)X(t)\)</span></p>
<p>Then <span class="math display">\[
\mathbb{E}[\hat{R_X}(\tau)] = R_X(\tau)
\]</span></p>
<h4 id="power-spectral-density">power spectral density</h4>
<h5 id="time-domain">time domain</h5>
<p>Define <span class="math display">\[
P_X = \mathbb{E}\left[ \lim_{T\to
\infty}\frac{1}{2T}\int_{-T}^{T}|X(t)|^2dt \right]
\]</span> Then we have <span class="math inline">\(P_X =
\frac{1}{2\pi}\int_{-\infty}^{\infty}S_X(\omega)d\omega\)</span> or
<span class="math inline">\(P_X =
\int_{-\infty}^{\infty}S_X(f)df\)</span></p>
<h5 id="frequency-domain">frequency domain</h5>
<p>The <em>power spectral density (PSD)</em> of a <em>WSS process</em>
is defined as <span class="math display">\[
S_X(\omega) = \lim_{T\to
\infty}\frac{\mathbb{E}[|\tilde{X}_T(\omega)|^2]}{2T}
\]</span> where <span class="math inline">\(\tilde{X}_T(\omega) =
\int_{-T}^{T}X(t)e^{-j\omega t}dt\)</span> is the Fourier transform of
<span class="math inline">\(X(t)\)</span> limited to <span
class="math inline">\([-T, T]\)</span>, Parseval's theorem is
applied.</p>
<p>That is <span class="math display">\[\begin{align}
P_X  &amp;= \frac{1}{2\pi}\int_{-\infty}^{\infty}S_X(\omega)d\omega \\
&amp;= \frac{1}{2\pi}\int_{-\infty}^{\infty}\lim_{T\to
\infty}\frac{\mathbb{E}[|\tilde{X}_T(\omega)|^2]}{2T}d\omega
\end{align}\]</span></p>
<h4 id="einstein-wiener-khinchin-theorem">Einstein-Wiener-Khinchin
Theorem</h4>
<blockquote>
<p>The Einstein-Wiener-Khinchin theorem is a fundamental result. It
states that for any <em>wide sense stationary process</em>, the power
spectral density <span class="math inline">\(S_X(\omega)\)</span> is the
Fourier transform of the autocorrelation function.</p>
</blockquote>
<p>The power spectral density <span
class="math inline">\(S_X(\omega)\)</span> of a <em>WSS process</em> is
<span class="math display">\[
S_X(\omega) = \int_{-\infty}^{\infty}R_X(\tau)e^{-j\omega \tau}d\tau =
\mathcal{F}(R_X(\tau))
\]</span> assuming that <span
class="math inline">\(\int_{-\infty}^{\infty}R_X(\tau)^2d\tau \lt
\infty\)</span> so that the Fourier transform of <span
class="math inline">\(R_X(\tau)\)</span> exists</p>
<p><img src="/2023/06/18/math-and-noise/image-20230715101317632.png"
alt="image-20230715101317632" /></p>
<h3 id="wiener-process-or-brownian-motion">Wiener Process (or Brownian
Motion)</h3>
<blockquote>
<p><span class="math inline">\(\text{SDE} = \text{ODE} +
\text{GWN}\)</span></p>
<p>where <span class="math inline">\(\text{GWN}\)</span> is
<strong>Gaussian White Noise</strong></p>
</blockquote>
<p>a Brownian Motion <span
class="math inline">\(\{W_t\}_{t:t\in[0,\infty]}\)</span> is a
stochastic process, whose conditional likelihood is Gaussian with a
variance that increase linearly in the time interval that one considers
and a zero mean</p>
<ul>
<li><span class="math inline">\(W_0 = 0\)</span></li>
<li><span class="math inline">\(W_t \sim \mathbb{N}(0, t)\)</span></li>
<li><span class="math inline">\(W_{t2} - W_{t1}\)</span> is independent
from <span class="math inline">\(W_{t4} - W_{t3}\)</span> for <span
class="math inline">\(0\leq t_1\leq t_2 \leq t_3 \leq t_4\)</span></li>
</ul>
<blockquote>
<p>Brownian motion <span class="math inline">\(W_t\)</span> is an
example of a <strong>Gaussian process</strong></p>
<p>Wiener process can be thought of as the <strong>integral</strong> of
white noise</p>
</blockquote>
<p>The implications of these assumptions are: <span
class="math display">\[
E[W_t] = 0
\]</span></p>
<p><span class="math display">\[
Var(W_t) = E[W_t^2] = t
\]</span></p>
<ul>
<li><p>A single trajectory <span class="math inline">\(t \to
W_t(\omega)\)</span> is <strong>continuous</strong>, yet extremely
spiky, that is <span class="math inline">\(\frac{dW_t}{dt}\)</span>
<strong>does not</strong> exist.</p></li>
<li><p>Yet, the Brownian Motion itself is well defined of course. that
is <span class="math inline">\(W_t = \int_0^tdW_u\)</span>
<strong>does</strong> exist</p></li>
</ul>
<p><span class="math display">\[
W_t = \int_0^tdW_u
\]</span></p>
<p>What does it really mean?</p>
<ul>
<li><span class="math inline">\(dW_t \sim \mathbb{N}(0,
dt)\)</span></li>
<li><span class="math inline">\(\frac{dW_t}{dt}\sim
\mathbb{N}(0,1)\)</span></li>
</ul>
<p><img src="/2023/06/18/math-and-noise/image-20230702094054155.png"
alt="image-20230702094054155" /></p>
<h3 id="ito-sde-with-brownian-motion">Ito SDE with Brownian Motion</h3>
<p><span class="math display">\[
\frac{dX_t}{dt} = f(X_t) + g(X_t)\frac{dW_t}{dt}
\]</span></p>
<p>is not well defined and hence only a popular <em>'Symbolic
Representation'</em></p>
<p>For SDEs, the proper representation is the <strong>'Pathwise
Stochastic Integral Representation'</strong></p>
<p><img src="/2023/06/18/math-and-noise/image-20230702155217093.png"
alt="image-20230702155217093" /></p>
<blockquote>
<p><strong>stochastic integral</strong>:</p>
<p>It doesnâ€™t have the same geometrically intuitive nature as the
Riemann integral, but there is an analogy here;</p>
<p>instead of a finite sum of simple functions which are rectangles, we
are now dealing with <strong>a finite sum of 'simple random variables'
multiplied by increments of a Brownian walk</strong>, which are
Gaussian.</p>
</blockquote>
<h2 id="stochastic-differential-equation-sde">stochastic differential
equation (SDE)</h2>
<h3 id="wiener-stochastic-integral">Wiener Stochastic Integral</h3>
<p>Let <span class="math inline">\(L^2([0,T])\)</span> denote the space
of measurable functions <span
class="math inline">\(f:[0,T]\longrightarrow \mathbb{R}\)</span> such
that <span class="math display">\[
||f||_{L^2([0,T])}=\sqrt{\int_0^T|f(t|^2dt}\lt \infty
\]</span> In the above definition, <span
class="math inline">\(||f||_{L^2([0,T])}\)</span> represents the norm of
the function <span class="math inline">\(f\in L^2([0,T])\)</span>, and
known as <em>square-integrable functions</em></p>
<p><span class="math inline">\(\int_0^Tf(t)dB_t\)</span> has the
centered Gaussian distribution <span class="math display">\[
\int_0^Tf(t)dB_t \simeq \mathbb{N}\left(0,\int_0^T|f(t)|^2dt\right)
\]</span> where <span class="math inline">\(f\in L^2([0,T])\)</span></p>
<p>The Wiener stochastic integral <span class="math inline">\(\int_0^T
f(t)dB_t\)</span> is a Gaussian random variable that cannot be
"computed" in the way standard integrals are computed via the use of
primitives. However, when <span class="math inline">\(f\in
L^2([0,T])\)</span> and is continuously differentiable on <span
class="math inline">\([0,T]\)</span>, we have the integration by parts
relation <span class="math display">\[
\int_0^Tf(t)dB_t = f(T)B_T -\int_0^TB_tf&#39;(t)dt
\]</span></p>
<h3 id="ito-stochastic-integral">Ito Stochastic Integral</h3>
<p>The biggest advantage of Ito formulation is that the evaluations of
the function are totally uncorrelated with the increment, by
contruction.</p>
<p>That is to say, that because we evaluate the function <span
class="math inline">\(f(x,B_t, t)\)</span> at the <strong>left</strong>
point of the midpoint, our limiting sum is <span class="math display">\[
\int f(x,B_t, t)dB_t = \lim_{N\to \infty}\sum
f(x_{t_k},B_{t_k},t_k)(B_{t_{k+1}}-B_{t_k})
\]</span></p>
<blockquote>
<p>For a deterministic integral, the convergence of the integral does
<strong>NOT</strong> depend on wheter the integrands is evaluated at the
left, mid or end point.</p>
<p>The Ito stochastic integral uses the left end point for the
integrand.</p>
</blockquote>
<p>But because the increment <span
class="math inline">\((B_{t_{k+1}}-B_{t_k})\)</span> is
<strong>uncorrelated</strong> with <span
class="math inline">\(B_{t_k}\)</span>, it's also <strong>uncorrelated
with any function of <span
class="math inline">\(B_{t_k}\)</span></strong>, i.e. <span
class="math inline">\(f(x_{t_k},B_{t_k},t_k)\)</span>. and the limiting
sum always has <strong>mean zero </strong></p>
<p>This leads to the nice property that an Ito integral <span
class="math display">\[
\int _S ^ T f(x, t)dB_t
\]</span> always has mean zero, and is a martingale</p>
<blockquote>
<p><span class="math inline">\(f(x, t)\)</span> omit <span
class="math inline">\(B_t\)</span> due to uncorrelated property</p>
</blockquote>
<h4 id="quadratic-variation">quadratic variation</h4>
<p>Step function approximation of Brownian motion</p>
<p><span class="math display">\[\begin{align}
E\left[\left( \int_0^Tu_t dB_t \right)^2\right] &amp;= E\left[\int_0^T
|u_t|^2 dt \right] \\
E\left[\int_0^T u_t dB_t\right] &amp;= 0
\end{align}\]</span></p>
<h4 id="basic-ito-formula">Basic Ito formula</h4>
<p>For <span class="math inline">\(f\)</span> is twice continuously
differentiable on <span class="math inline">\([0, T]\)</span>, Taylor's
formula written at the second order for Brownian motion reads <span
class="math display">\[
df(B_t) = f&#39;(B_t)dB_t + \frac{1}{2}f^{&#39;&#39;}(B_t)dt
\]</span> for <strong>infinitesimally small</strong> <span
class="math inline">\(dt\)</span>.</p>
<p>Note that writing this formula as <span class="math display">\[
\frac{df(B_t)}{dt}=f&#39;(B_t)\frac{dB_t}{dt}+\frac{1}{2}f^{&#39;&#39;}(B_t)
\]</span> <strong>does not</strong> make sense because the pathwise
derivative <span class="math display">\[
\frac{dB_t}{dt}\simeq \pm\frac{\sqrt{dt}}{dt}\simeq
\pm\frac{1}{\sqrt{dt}}\simeq \pm\infty
\]</span> of <span class="math inline">\(B_t\)</span> with respect to
<span class="math inline">\(t\)</span> does not exist.</p>
<p>With <span class="math inline">\(f(B_t)-f(B_0)=\int_0^t
df(B_s)\)</span>, we get the integral form of Ito formula for Brownian
motion <span class="math display">\[
f(B_t) =
f(B_0)+\int_0^tf&#39;(B_s)dB_s+\frac{1}{2}\int_0^tf^{&#39;&#39;}(B_s)ds
\]</span></p>
<h4 id="ito-processes">Ito processes</h4>
<p>A stochastic process <span class="math inline">\((X_t)_{t\in
\mathbb{R}_+}\)</span> that can be written as <span
class="math display">\[
X_t = X_0 + \int_0^t v_sds + \int_0^t u_sdB_s,\quad t\geq0
\]</span> or differential notation <span class="math display">\[
dX_t = v_tdt + u_tdB_t
\]</span> where <span
class="math inline">\((u_t)_{t\in\mathbb{R}_+}\)</span> and <span
class="math inline">\((v_t)_{t\in\mathbb{R}_+}\)</span> are
<em>square-integrable adapted process</em></p>
<h4 id="ito-formula-for-ito-processes">Ito formula for Ito
processes</h4>
<p>For any Ito process <span
class="math inline">\((X_t)_{t\in\mathbb{R}_+}\)</span> and any <span
class="math inline">\(f\)</span> that is continuously differentiable on
<span class="math inline">\(t\in[0,T]\)</span> and twice differentiable
in <span class="math inline">\(x\in\mathbb{R}\)</span>, with bounded
derivatives <span class="math display">\[
f(t,X_t) = f(0,X_0)+\int_0^t\frac{\partial f}{\partial s}(s,X_s)ds +
\int_0^t v_s\frac{\partial f}{\partial x}(s,X_s)ds + \int_0^t
u_s\frac{\partial f}{\partial
x}(s,X_s)dB_s+\frac{1}{2}\int_0^t|u_s|^2\frac{\partial ^2 f}{\partial
x^2}(s,X_s)ds
\]</span> Due to <span class="math inline">\(\int_0^t
df(s,X_s)=f(t,X_t)-f(0,X_0)\)</span> <span class="math display">\[
\int_0^t df(s,X_s)=\int_0^t\frac{\partial f}{\partial s}(s,X_s)ds +
\int_0^t v_s\frac{\partial f}{\partial x}(s,X_s)ds + \int_0^t
u_s\frac{\partial f}{\partial
x}(s,X_s)dB_s+\frac{1}{2}\int_0^t|u_s|^2\frac{\partial ^2 f}{\partial
x^2}(s,X_s)ds
\]</span> which allow us to rewrite in differential notation, as <span
class="math display">\[
df(t,X_t) = \frac{\partial f}{\partial t}(t,X_t)dt + v_t\frac{\partial
f}{\partial x}(t, X_t)dt+u_t\frac{\partial f}{\partial
x}(t,X_t)dB_t+\frac{1}{2}|u_t|^2\frac{\partial ^2 f}{\partial x^2}(t,
X_t)dt
\]</span></p>
<ul>
<li><p>In case the function <span class="math inline">\(x \to
f(x)\)</span> does <strong>not depend on the time variable <span
class="math inline">\(t\)</span></strong>, we get <span
class="math display">\[
df(X_t) = v_t\frac{\partial f}{\partial x}(X_t)dt+u_t\frac{\partial
f}{\partial x}(X_t)dB_t+\frac{1}{2}|u_t|^2\frac{\partial ^2 f}{\partial
x^2}(X_t)dt
\]</span></p></li>
<li><p><span class="math inline">\(X_t = B_t\)</span> while taking <span
class="math inline">\(v_t=0\)</span>, <span
class="math inline">\(u_t=1\)</span> and <span
class="math inline">\(X_0=0\)</span> in Ito process, Ito formula reads
<span class="math display">\[
f(t, B_t) = f(0, B_0)+\int_0^t\frac{\partial f}{\partial s}(s,B_s)ds +
\int_0^t\frac{\partial f}{\partial
x}(s,B_s)dB_s+\frac{1}{2}\int_0^t\frac{\partial ^2 f}{\partial
x^2}(s,B_s)ds
\]</span> i.e. in differential notation: <span class="math display">\[
df(t, B_t) = \frac{\partial f}{\partial t}(t,B_t)dt + \frac{\partial
f}{\partial x}(t,B_t)dB_t+\frac{1}{2}\frac{\partial ^2 f}{\partial
x^2}(t,B_t)dt
\]</span></p></li>
</ul>
<hr />
<p><strong>Ito Lemma</strong>, it says that if the input to a function
follows an Ito SDE, then the output to a sufficiently smooth function
follows also an Ito SDE.</p>
<p><img src="/2023/06/18/math-and-noise/image-20230702160220762.png"
alt="image-20230702160220762" /></p>
<hr />
<h4 id="bivariate-ito-formula">Bivariate Ito formula</h4>
<p>Consider two Ito processes <span class="math inline">\((X_t)_{t\in
\mathbb{R} _+}\)</span> and <span class="math inline">\((Y_t)_{t\in
\mathbb{R} _+}\)</span> written in <em>integral form</em> as</p>
<p><span class="math display">\[\begin{align}
X_t &amp;= X_0 + \int_0^t v_sds + \int_0^t u_s dB_s, \quad t \geq 0 \\
Y_t &amp;= Y_0 + \int_0^t b_sds + \int_0^t a_s dB_s, \quad t \geq 0
\end{align}\]</span></p>
<p>or in <em>differential notation</em> as</p>
<p><span class="math display">\[\begin{align}
dX_t &amp;= v_t dt +u_tdB_t \\
dY_t &amp;= b_tdt + a_tdB_t
\end{align}\]</span></p>
<p>The Ito formula can also be written for functions <span
class="math inline">\(f\)</span> of two state variables as</p>
<p><span class="math display">\[\begin{align}
df(t,X_t, Y_t) &amp;= \frac{\partial f}{\partial t}(t,X_t,Y_t)dt +
\frac{\partial f}{\partial x}(t, X_t, Y_t)dX_t +
\frac{1}{2}|u_t|^2\frac{\partial ^2 f}{\partial x^2}(t, X_t, Y_t)dt \\
&amp;+\frac{\partial f}{\partial y}(t, X_t, Y_t)d_t +
\frac{1}{2}|a_t|^2\frac{\partial ^2 f}{\partial y^2}(t, X_t, Y_t)dt +
u_ta_t\frac{\partial ^2 f}{\partial x \partial y}(t,X_t,Y_t)dt
\end{align}\]</span></p>
<h4 id="ito-multiplication-table">Ito multiplication table</h4>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(\cdot\)</span></th>
<th><span class="math inline">\(dt\)</span></th>
<th><span class="math inline">\(dB_t\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(dt\)</span></td>
<td><span class="math inline">\(0\)</span></td>
<td><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(dB_t\)</span></td>
<td><span class="math inline">\(0\)</span></td>
<td><span class="math inline">\(dt\)</span></td>
</tr>
</tbody>
</table>
<p>That is</p>
<p><span class="math display">\[\begin{align}
dt\cdot dt &amp;= 0 \\
dt\cdot dB_t &amp;= 0 \\
dB_t \cdot dB_t &amp;= dt
\end{align}\]</span></p>
<p>It follows from above Ito table that</p>
<p><span class="math display">\[\begin{align}
dX_t \cdot dY_t &amp;= (v_tdt+u_tdB_t)\cdot (b_tdt + a_tdB_t) \\
&amp;= b_tv_t(dt)^2+b_tu_tdtdB_t +a_tv_tdtdB_t +a_tu_t(dB_t)^2 \\
&amp;= a_tu_t dt
\end{align}\]</span></p>
<p>and we also have <span class="math display">\[\begin{align}
(dX_t)^2 &amp;= (v_tdt + u_tdB_t)^2 \\
&amp;= (v_t)^2 (dt)^2 + (u_t)^2(dB_t)^2 + 2u_tv_t(dt\cdot dB_t) \\
&amp;= (u_t)^2dt
\end{align}\]</span></p>
<blockquote>
<p><span class="math inline">\(dB_t = \sqrt{dt}\)</span></p>
</blockquote>
<h4 id="ito-formula-using-ito-multiplication-table">Ito formula using
Ito multiplication table</h4>
<p>with <span class="math inline">\((u_t)^2dt=(dX_t)^2\)</span> and
<span class="math inline">\(X_t = v_tdt + u_tdB_t\)</span>, Ito
formula's differential notation can be rewritten as <span
class="math display">\[\begin{align}
df(t,X_t) &amp;= \frac{\partial f}{\partial t}(t,X_t)dt +
v_t\frac{\partial f}{\partial x}(t, X_t)dt+u_t\frac{\partial f}{\partial
x}(t,X_t)dB_t+\frac{1}{2}|u_t|^2\frac{\partial ^2 f}{\partial x^2}(t,
X_t)dt \\
&amp;= \frac{\partial f}{\partial t}(t,X_t)dt + \frac{\partial
f}{\partial x}(t,X_t)\cdot (v_tdt + u_tdB_t) + \frac{1}{2}\frac{\partial
^2 f}{\partial x^2}(t, X_t)\cdot |u_t|^2dt \\
&amp;= \frac{\partial f}{\partial t}(t,X_t)dt + \frac{\partial
f}{\partial x}(t,X_t)dX_t + \frac{1}{2}\frac{\partial ^2 f}{\partial
x^2}(t, X_t)\cdot (dX_t)^2 \\
&amp; = \frac{\partial f}{\partial t}(t,X_t)dt + \frac{\partial
f}{\partial x}(t,X_t)dX_t + \frac{1}{2}\frac{\partial ^2 f}{\partial
x^2}(t, X_t)dX_t\cdot dX_t
\end{align}\]</span></p>
<p>and the Ito formula for function <span
class="math inline">\(f\)</span> of two state variables can be rewritten
as</p>
<p><span class="math display">\[\begin{align}
df(t,X_t, Y_t)
&amp;= \frac{\partial f}{\partial t}(t,X_t,Y_t)dt + \frac{\partial
f}{\partial x}(t, X_t, Y_t)dX_t + \frac{1}{2}\frac{\partial ^2
f}{\partial x^2}(t, X_t, Y_t)(dX_t))^2 \\
&amp;+\frac{\partial f}{\partial y}(t, X_t, Y_t)d_t +
\frac{1}{2}\frac{\partial ^2 f}{\partial y^2}(t, X_t, Y_t)(dY_t)^2 +
\frac{\partial ^2 f}{\partial x \partial y}(t,X_t,Y_t)(dX_t\cdot dY_t)
\end{align}\]</span></p>
<p>where <span class="math inline">\((dX_t)^2 = |u_t|^2dt\)</span>,
<span class="math inline">\((dY_t)^2=|a_t|^2dt\)</span> and <span
class="math inline">\(dX_t\cdot dY_t = u_ta_tdt\)</span></p>
<h2 id="solving-a-geometric-brownian-motion">Solving a Geometric
Brownian Motion</h2>
<h3 id="geometric-brownian-motion-gbm">Geometric Brownian motion
(GBM)</h3>
<p>A <strong>geometric Brownian motion (GBM)</strong> (also known as
<strong>exponential Brownian motion</strong>)</p>
<p>A stochastic process <span class="math inline">\(S_t\)</span> is said
to follow a <strong>GBM</strong> if it satisfies the following (SDE) [<a
target="_blank" rel="noopener" href="https://en.wikipedia.org/w/index.php?title=Geometric_Brownian_motion&amp;oldid=1161374200">link</a>]:
<span class="math display">\[
dS_t = \mu S_t dt + \sigma S_t dW_t
\]</span> where <span class="math inline">\(W_t\)</span> is a Wiener
process or Brownian motion</p>
<p>and <span class="math inline">\(\mu\)</span> ('the percentage drift')
and <span class="math inline">\(\sigma\)</span> ('the percentage
volatility') are constants.</p>
<blockquote>
<p>The former parameter is used to model deterministic trends,</p>
<p>while the latter parameter models unpredictable events occurring
during the motion.</p>
</blockquote>
<h3 id="solving-step-by-step">solving step by step</h3>
<p>[<a target="_blank" rel="noopener" href="https://youtu.be/y0s2GXREymI">Quant Guild</a>]</p>
<p>Given the stochastic differential equation <span
class="math display">\[
dS_t = \mu S_t dt + \sigma S_t dW_t, \quad t\in[t_0, T]
\]</span> that represents the dynamics of a stock process, it is
desirable to recover the function for simulation.</p>
<p>First, recall <strong>Ito lemma</strong> where <span
class="math inline">\(y(t, X_t)\)</span> represents a time-dependent
function of a stochastic process <span class="math display">\[
dy(t,X_t) = \frac{\partial y}{\partial t}dt + \frac{\partial y}{\partial
X_t}dX_t + \frac{1}{2}\frac{\partial ^2 y}{\partial X_t^2}(dX_t)^2
\]</span> Now, consider the following log transformation of the stock
process <span class="math display">\[
g(S_t) = \ln(S_t)
\]</span> We can apply Ito lemma to the log transformation function
<span class="math display">\[
dg(S_t) = \frac{\partial g}{\partial t}dt + \frac{\partial g}{\partial
S_t}dS_t +\frac{1}{2}\frac{\partial ^2 g}{\partial X_t^2}(dX_t)^2
\]</span> It follows from <span class="math inline">\(g(S_t) =
\ln(S_t)\)</span> and <span class="math inline">\(dS_t = \mu S_t dt +
\sigma S_t dW_t\)</span> with <em>Ito multiplication table</em> <span
class="math display">\[\begin{align}
\frac{\partial g}{\partial t} &amp;= 0 \\
\frac{\partial g}{\partial S_t} &amp;= \frac{1}{S_t} \\
\frac{\partial ^2  g}{\partial S_t ^2} &amp;= -\frac{1}{S_t^2} \\
(dX_t)^2 &amp;= 0 + 0 + \sigma^2S_t^2(dW_t)^2 = \sigma^2S_t^2dt
\end{align}\]</span></p>
<p>By substitution of these results into <span
class="math inline">\(dg(S_t) = \frac{\partial g}{\partial t}dt +
\frac{\partial g}{\partial S_t}dS_t +\frac{1}{2}\frac{\partial ^2
y}{\partial X_t^2}(dX_t)^2\)</span>, we obtain <span
class="math display">\[\begin{align}
dg(S_t) &amp;= 0 + \frac{1}{S_t}(\mu S_t dt + \sigma S_t dW_t) +
\frac{1}{2}(-\frac{1}{S_t^2})\sigma^2S_t^2dt \\
&amp;= \mu dt + \sigma dW_t - \frac{1}{2}\sigma^2 dt \\
&amp;= \left(\mu - \frac{1}{2}\sigma^2\right) + \sigma dW_t
\end{align}\]</span></p>
<p>We can now integrate both sides <span class="math display">\[
\int_{t_0}^Tdg(S_t) = \int_{t_0}^T \left(\mu -
\frac{1}{2}\sigma^2\right)dt + \int_{t_0}^T\sigma dW_t
\]</span></p>
<p><span class="math display">\[
g(S_t) - g(S_{t_0}) = \left(\mu - \frac{1}{2}\sigma^2\right)(T - {t_0})
+ \sigma(W_T - W_{t_0})
\]</span></p>
<p>Let's substitute <span class="math inline">\(g(S_t) =
\ln(S_t)\)</span> into above equation <span class="math display">\[
\ln(S_t) - \ln(S_{t_0}) = \left(\mu - \frac{1}{2}\sigma^2\right)(T -
{t_0}) + \sigma(W_T - W_{t_0})
\]</span> after arranging, the closed form solution is <span
class="math display">\[
S_T = S_{t_0}e^{(\mu-\frac{1}{2}\sigma^2)(T-t_0)+\sigma(W_T-W_{t_0})}
\]</span></p>
<h1 id="reference">reference</h1>
<h2 id="paper">paper</h2>
<p>A. Demir, A. Mehrotra and J. Roychowdhury, "Phase noise in
oscillators: a unifying theory and numerical methods for
characterization," in IEEE Transactions on Circuits and Systems I:
Fundamental Theory and Applications, vol. 47, no. 5, pp. 655-674, May
2000, doi: 10.1109/81.847872. [<a
target="_blank" rel="noopener" href="https://www.researchgate.net/profile/Jaijeet-Roychowdhury/publication/3774912_Phase_noise_in_oscillators_a_unifying_theory_and_numerical_methods_for_characterisation/links/56436c0308ae54697fb2e543/Phase-noise-in-oscillators-a-unifying-theory-and-numerical-methods-for-characterisation.pdf">pdf</a>]</p>
<p>demir, Alper. (2000). Floquet theory and non-linear perturbation
analysis for oscillators with differential-algebraic equations.
International Journal of Circuit Theory and Applications - INT J CIRCUIT
THEOR APPL. 28. 163-185.
10.1002/(SICI)1097-007X(200003/04)28:23.0.CO;2-K.</p>
<h2 id="book">book</h2>
<p>â­ Levy, Bernard. (2020). <strong>Random Processes with Applications
to Circuits and Communications</strong>. 10.1007/978-3-030-22297-0.</p>
<p>Sundararajan, D.. (2023). <strong>Signals and Systems: A Practical
Approach</strong>. 10.1007/978-3-031-19377-4.</p>
<p>Ã˜ksendal, Bernt. (2000). <strong>Stochastic Differential Equations:
An Introduction with Applications</strong>.
10.1007/978-3-662-03185-8.</p>
<p>Chicone, Carmen Charles. <strong>Ordinary Differential Equations with
Applications. 2nd ed</strong>. New York ; Berlin: Springer, 2006.</p>
<p>â­ Stanley H. Chan (2021). <strong>Introduction to Probability for
Data Science</strong>. Michigan Publishing, [<a
target="_blank" rel="noopener" href="https://probability4datascience.com/index.html">link</a>]</p>
<p>Simo SÃ¤rkkÃ¤ and Arno Solin (2019). <strong>Applied Stochastic
Differential Equations</strong>. Cambridge University Press. Cambridge,
UK. [<a target="_blank" rel="noopener" href="https://github.com/AaltoML/SDE">link</a>]</p>
<p>Gerald Teschl, <strong>Ordinary Differential Equations and Dynamical
Systems</strong> A.M.S., 2012</p>
<p>Kurt Bryan; Brian Winkel (2020), "2021-Bryan, Kurt - SIMIODE Online
Digital Textbook - <strong>Differential Equations: A Toolbox for
Modeling the World</strong>.,"
https://www.simiode.org/resources/8208.</p>
<p>Jordan, D.W. and Smith, P. (2007) <strong>Nonlinear Ordinary
Differential Equations: An Introduction for Scientists and Engineers.
4th Edition</strong>, Oxford University Press, New York.</p>
<p>Strogatz, S.H. (2015). <strong>Nonlinear Dynamics and Chaos: With
Applications to Physics, Biology, Chemistry, and Engineering (2nd
ed.)</strong>. CRC Press. https://doi.org/10.1201/9780429492563</p>
<p>â­ Nicolas Privault. <strong>Introduction to Stochastic Finance with
Market Examples, Second Edition</strong>, Chapman &amp; Hall/CRC
Financial Mathematics Series, 2022</p>
<p>â­ Nicolas Privault. <strong>MH4514 Financial Mathematics</strong>
[<a target="_blank" rel="noopener" href="https://personal.ntu.edu.sg/nprivault/indext.html">link</a>,
<a
target="_blank" rel="noopener" href="https://drive.google.com/file/d/1iCsMdtJctWK2fo65WP5iqNvQ73acObzU">MH4514_notes</a>]</p>
<p>Evans, Lawrence C.. <strong>Stochastic differential equations version
1.2</strong> [<a
target="_blank" rel="noopener" href="https://www.cmor-faculty.rice.edu/~cox/stoch/SDE.course.pdf">pdf</a>]</p>
<p>Evans, Lawrence C.. <strong>An Introduction to Stochastic
Differential Equations.</strong> (2014).</p>
<p>â­ Matt Charnley. <strong>Differential Equations: An Introduction for
Engineers</strong> [<a
target="_blank" rel="noopener" href="https://sites.rutgers.edu/matthew-charnley/course-materials/differential-equations-an-introduction-for-engineers/">link</a>]</p>
<p>â­ JiÅ™Ã­ Lebl. <strong>Notes on Diffy Qs: Differential Equations for
Engineers</strong> [<a
target="_blank" rel="noopener" href="https://www.jirka.org/diffyqs/">link</a>]</p>
<h2 id="measure-theoretic-probability-theory">measure-theoretic
probability theory</h2>
<p>Jacod, J., &amp; Protter, P. (2004). <strong>Probability Essentials
(Second edition.)</strong>. Springer Berlin Heidelberg.</p>
<p>Sebastien Roch, UW-Madison. <strong>Lecture Notes on
Measure-theoretic Probability Theory</strong> [<a
target="_blank" rel="noopener" href="https://people.math.wisc.edu/~roch/grad-prob/index.html">link</a>]</p>
<p>Matthew N. Bernstein <strong>Demystifying measure-theoretic
probability theory</strong> [<a
target="_blank" rel="noopener" href="https://mbernste.github.io/posts/self_info/">part1</a>, <a
target="_blank" rel="noopener" href="https://mbernste.github.io/posts/measure_theory_2/">part2</a>, <a
target="_blank" rel="noopener" href="https://mbernste.github.io/posts/measure_theory_3/">part3</a>]</p>
<p>Edwin Chen. <strong>Layman's Introduction to Measure Theory</strong>
[<a
target="_blank" rel="noopener" href="https://blog.echen.me/2011/03/14/laymans-introduction-to-measure-theory/">link</a>]</p>
<p>Ales CernÃ½. <strong>Mathematical Techniques in Finance: Tools for
Incomplete Markets - Second Edition</strong></p>
<h2 id="blogs">blogs</h2>
<p>â­Â Prof. Dr. Maxim Ulrich, KIT. <strong>Stochastic Calculus:
Basics</strong> [<a
target="_blank" rel="noopener" href="https://youtube.com/playlist?list=PLyQSjcv8LwAEdNgdVnNH02-JTJfrwCt81">link</a>]</p>
<p>â­Â Lewis Smith. <strong>ItÃ´ and Stratonovich; a guide for the
perplexed</strong> [<a
target="_blank" rel="noopener" href="https://www.robots.ox.ac.uk/~lsgs/posts/2018-09-30-ito-strat.html">link</a>]</p>
<p>å¸ƒæœ—è¿åŠ¨ã€ä¼Šè—¤å¼•ç†ã€BS å…¬å¼ï¼ˆå‰ç¯‡ï¼‰ [<a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/38293827">link</a>]</p>
<p>Wiener Process <span class="math inline">\(dB^2=dt\)</span> [<a
target="_blank" rel="noopener" href="https://math.stackexchange.com/q/81865/1059887">https://math.stackexchange.com/q/81865/1059887</a>]</p>
<p>Professor Steve Lalley Statistics 385: Brownian Motion and Stochastic
Calculus Fall 2016 [<a
target="_blank" rel="noopener" href="https://galton.uchicago.edu/~lalley/Courses/385/">link</a>]</p>
<p>18.S096 | Fall 2013 | Undergraduate MIT. Topics In Mathematics With
Applications In Finance [<a
target="_blank" rel="noopener" href="https://ocw.mit.edu/courses/18-s096-topics-in-mathematics-with-applications-in-finance-fall-2013/pages/syllabus/">link</a>]</p>
<p>Mathuranathan, Power and Energy of a Signal : Demystified URL: <a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2013/12/power-and-energy-of-a-signal/">https://www.gaussianwaves.com/2013/12/power-and-energy-of-a-signal/</a></p>
<p>White Noise : Simulation and Analysis using Matlab gaussianwaves.com
[<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2013/11/simulation-and-analysis-of-white-noise-in-matlab/">link</a>]</p>
<p>Prof. J. Nathan Kutz AMATH 568 Advanced Differential Equations:
Asymptotics &amp; Perturbations [<a
target="_blank" rel="noopener" href="https://faculty.washington.edu/kutz/am568/am568.html">link</a>]</p>
<p>Asymptotics and perturbation methods - Prof. Steven Strogatz [<a
target="_blank" rel="noopener" href="https://youtube.com/playlist?list=PL5EH0ZJ7V0jV7kMYvPcZ7F9oaf_YAlfbI">link</a>]
via <span class="citation" data-cites="YouTube">@YouTube</span></p>
<p>Simo SÃ¤rkkÃ¤ and Arno Solin (2014). <strong>Applied Stochastic
Differential Equations</strong>. <em>Lecture notes of the course
Becs-114.4202 Special Course in Computational Engineering II held in
Autumn 2014</em>. (<a
target="_blank" rel="noopener" href="https://users.aalto.fi/~ssarkka/course_s2014/sde_course_booklet.pdf">Booklet
as PDF</a>, <a
target="_blank" rel="noopener" href="https://users.aalto.fi/~ssarkka/course_s2014/">Slides and
exercises</a>). (2012 material is <a
target="_blank" rel="noopener" href="https://users.aalto.fi/~ssarkka/course_s2012/pdf/">here</a>).</p>
<p>Ben Chugg. ItÃ´ Integral: Construction and Basic Properties [<a
target="_blank" rel="noopener" href="https://benchugg.com/research_notes/intro_ito/">link</a>]</p>
<p>Ben Chugg. ItÃ´ Processes and The Fundamental Theorem of Stochastic
Calculus [<a
target="_blank" rel="noopener" href="https://benchugg.com/research_notes/sde_ito_lemma/">link</a>]</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/06/05/hdltime/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/06/05/hdltime/" class="post-title-link" itemprop="url">time format in Verilog</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-06-05 22:33:51" itemprop="dateCreated datePublished" datetime="2023-06-05T22:33:51+00:00">2023-06-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:21" itemprop="dateModified" datetime="2023-09-24T16:23:21+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/digital/" itemprop="url" rel="index"><span itemprop="name">digital</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="realtime-vs-time">realtime vs time</h2>
<ul>
<li><p><code>$realtime</code> round the current time to
<code>timeprecision</code></p></li>
<li><p><code>$time</code> round the current time to integer</p></li>
<li><p><code>%t</code> will scale the rounded value to represent
<code>timeprecision</code>,</p>
<p>i.e. <span class="math inline">\([\$\text{realtime},
\$\text{time}]\cdot \$\text{timeunit} /
\$\text{timeprecision}\)</span></p></li>
</ul>
<p><a
target="_blank" rel="noopener" href="https://verificationacademy.com/forums/systemverilog/time-vs-realtime#answer-94062">https://verificationacademy.com/forums/systemverilog/time-vs-realtime#answer-94062</a>
<a
target="_blank" rel="noopener" href="https://verificationacademy.com/forums/systemverilog/time-vs-realtime#answer-94096">https://verificationacademy.com/forums/systemverilog/time-vs-realtime#answer-94096</a></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> tb;</span><br><span class="line">  <span class="keyword">timeunit</span> <span class="number">10</span>ns;</span><br><span class="line">  <span class="keyword">timeprecision</span> <span class="number">1</span>ps;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;$realtime = %g&quot;</span>, <span class="built_in">$realtime</span>);</span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;$time = %g&quot;</span>, <span class="built_in">$time</span>);</span><br><span class="line">    <span class="comment">// $realtime round to timeprecision</span></span><br><span class="line">    <span class="comment">// $time round to integer</span></span><br><span class="line">    #<span class="number">1</span><span class="variable">.10016</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;$realtime = %g&quot;</span>, <span class="built_in">$realtime</span>);</span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;$time = %g&quot;</span>, <span class="built_in">$time</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// %t format will scale the rounded value to represent timeprecision</span></span><br><span class="line">    <span class="comment">// 1.1002*10e-9/1e-12 = 11002</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;$realtime %%t = %t&quot;</span>, <span class="built_in">$realtime</span>);</span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;$time %%t = %t&quot;</span>, <span class="built_in">$time</span>);</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>output <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$realtime = 0</span><br><span class="line">$time = 0</span><br><span class="line">$realtime = 1.1002</span><br><span class="line">$time = 1</span><br><span class="line">$realtime %t =                11002</span><br><span class="line">$time %t =                10000</span><br></pre></td></tr></table></figure></p>
<h2 id="timeunit-timeprecision">timeunit, timeprecision</h2>
<p>The time unit and time precision can be specified in the following
two ways: - Using the compiler directive <code>`timescale</code> - Using
the keywords <code>timeunit</code> and <code>timeprecision</code>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> D (...);</span><br><span class="line">  <span class="keyword">timeunit</span> <span class="number">100</span>ps;</span><br><span class="line">  <span class="keyword">timeprecision</span> <span class="number">10</span>fs;</span><br><span class="line">  ...</span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> E (...);</span><br><span class="line">  <span class="keyword">timeunit</span> <span class="number">100</span>ps / <span class="number">10</span>fs; <span class="comment">// timeunit with optional second argument</span></span><br><span class="line">  ...</span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure></p>
<p>The minimum of <code>timeprecision</code> determine <code>%t</code>
output, the nearest <code>timeunit</code> and <code>timeprecision</code>
determine the round of <code>$realtime</code> and <code>$time</code>. Of
course, the simulator follow the time tick shown by
<code>$realtime</code>.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns/1ns</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Due to minimum of timeprecision is 10ps</span></span><br><span class="line"><span class="keyword">module</span> rawplant;</span><br><span class="line">  <span class="keyword">timeunit</span> <span class="number">1</span>ns;</span><br><span class="line">  <span class="keyword">timeprecision</span> <span class="number">100</span>ps;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">task</span> print;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1ns: 1</span></span><br><span class="line"><span class="comment">    100ps:  6</span></span><br><span class="line"><span class="comment">    10ps: 6</span></span><br><span class="line"><span class="comment">    1ps: 6</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    #<span class="number">1</span><span class="variable">.666</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;raw: $realtime = %g&quot;</span>, <span class="built_in">$realtime</span>);     <span class="comment">// 1.7</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;raw: $time = %g&quot;</span>, <span class="built_in">$time</span>);             <span class="comment">// 2</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;raw: $realtime %%t = %t&quot;</span>, <span class="built_in">$realtime</span>); <span class="comment">// 1.7*1ns/10ps=170</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;raw: $time %%t = %t&quot;</span>, <span class="built_in">$time</span>);         <span class="comment">// 2*1ns/10ps = 200</span></span><br><span class="line">  <span class="keyword">endtask</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> fineplant;</span><br><span class="line">  <span class="keyword">timeunit</span> <span class="number">100</span>ps;</span><br><span class="line">  <span class="keyword">timeprecision</span> <span class="number">10</span>ps;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">task</span> print;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    100ps: 2</span></span><br><span class="line"><span class="comment">    10ps: 6</span></span><br><span class="line"><span class="comment">    1ps: 6</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    #<span class="number">2</span><span class="variable">.66</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;fine: $realtime = %g&quot;</span>, <span class="built_in">$realtime</span>);     <span class="comment">// 2.7</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;fine: $time = %g&quot;</span>, <span class="built_in">$time</span>);             <span class="comment">// 3</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;fine: $realtime %%t = %t&quot;</span>, <span class="built_in">$realtime</span>); <span class="comment">// 2.7*100ps/10ps = 27</span></span><br><span class="line">    <span class="built_in">$display</span>(<span class="string">&quot;fine: $time %%t = %t&quot;</span>, <span class="built_in">$time</span>);         <span class="comment">// 3*100ps/10ps = 30</span></span><br><span class="line">  <span class="keyword">endtask</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> tb;</span><br><span class="line">  rawplant rawblock();</span><br><span class="line">  fineplant fineblock();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">fork</span></span><br><span class="line">    rawblock<span class="variable">.print</span>();</span><br><span class="line">    fineblock<span class="variable">.print</span>();</span><br><span class="line">  <span class="keyword">join</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>output <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fine: $realtime = 2.7</span><br><span class="line">fine: $time = 3</span><br><span class="line">fine: $realtime %t =                   27</span><br><span class="line">fine: $time %t =                   30</span><br><span class="line">raw: $realtime = 1.7</span><br><span class="line">raw: $time = 2</span><br><span class="line">raw: $realtime %t =                  170</span><br><span class="line">raw: $time %t =                  200</span><br></pre></td></tr></table></figure></p>
<h2 id="questasim-cmd">questasim cmd</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vlib work</span><br><span class="line">vlog tb.v</span><br><span class="line">vsim -c -<span class="keyword">do</span> <span class="string">&quot;run -all;exit&quot;</span> work.tb</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/06/03/variants-def-psd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/06/03/variants-def-psd/" class="post-title-link" itemprop="url">Different Variants of the PSD Definition</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-06-03 18:45:33" itemprop="dateCreated datePublished" datetime="2023-06-03T18:45:33+00:00">2023-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:21" itemprop="dateModified" datetime="2023-09-24T16:23:21+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>In the practice of engineering, it has become customary to use
slightly different variants of the PSD definition, depending on the
particular application or research field.</p>
<ul>
<li><p><strong>Two-Sided PSD</strong>, <span
class="math inline">\(S_x(f)\)</span></p>
<p>this is a synonym of the PSD defined as the Fourier Transform of the
<strong>autocorrelation</strong>.</p></li>
<li><p><strong>One-Sided PSD</strong>, <span
class="math inline">\(S&#39;_x(f)\)</span></p>
<p>this is a variant derived from the <em>two-sided PSD</em> by
considering only the <em>positive frequency</em> semi-axis.</p>
<p>To <strong>conserve the total power</strong>, the value of the
one-sided PSD is <strong>twice</strong> that of the two-sided PSD <span
class="math display">\[
S&#39;_x(f) = \left\{ \begin{array}{cl}
0 &amp; : \ f \geq 0 \\
S_x(f) &amp; : \ f = 0 \\
2S_x(f) &amp; : \ f \gt 0
\end{array} \right.
\]</span></p></li>
</ul>
<p><img src="/2023/06/03/variants-def-psd/image-20230603185546658.png"
alt="image-20230603185546658" /></p>
<blockquote>
<p>Note that the one-sided PSD definition makes sense only if the
two-sided is an even function of <span
class="math inline">\(f\)</span></p>
</blockquote>
<p>If <span class="math inline">\(S&#39;_x(f)\)</span> is even
symmetrical around a positive frequency <span
class="math inline">\(f_0\)</span>, then two additional definitions can
be adopted:</p>
<ul>
<li><p><strong>Single-Sideband PSD</strong>, <span
class="math inline">\(S_{SSB,x}(f)\)</span></p>
<p>This is obtained from <span
class="math inline">\(S&#39;_x(f)\)</span> by moving the origin of the
frequency axis to <span class="math inline">\(f_0\)</span> <span
class="math display">\[
S_{SSB,x}(f) =S&#39;_x(f+f_0)
\]</span> This concept is particularly useful for describing phase or
amplitude modulation schemes in wireless communications, where <span
class="math inline">\(f_0\)</span> is the carrier frequency.</p>
<blockquote>
<p>Note that there is no difference in the values of the one-sided
versus the SSB PSD; it is just a pure translation on the frequency
axis.</p>
</blockquote></li>
<li><p><strong>Double-Sideband PSD</strong>, <span
class="math inline">\(S_{DSB,x}(f)\)</span></p>
<p>this is a variant of the SSB PSD obtained by considering only the
positive frequency semi-axis.</p>
<p>As in the case of the one-sided PSD, to conserve total power, the
value of the DSB PSD is twice that of the SSB <span
class="math display">\[
S_{DSB,x}(f) = \left\{ \begin{array}{cl}
0 &amp; : \ f \geq 0 \\
S_{SSB,x}(f) &amp; : \ f = 0 \\
2S_{SSB,x}(f) &amp; : \ f \gt 0
\end{array} \right.
\]</span></p></li>
</ul>
<p><img src="/2023/06/03/variants-def-psd/image-20230603222054506.png"
alt="image-20230603222054506" /></p>
<blockquote>
<p>Note that the DSB definition makes sense only if the SSB PSD is even
symmetrical around zero</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Da Dalt, N., &amp; Sheikholeslami, A. (2018). Understanding jitter
and phase noise: A circuits and systems perspective. Cambridge
University Press.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/29/enbw-nl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/29/enbw-nl/" class="post-title-link" itemprop="url">Effective Noise BandWidth and Noise Floor</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-29 23:57:28" itemprop="dateCreated datePublished" datetime="2023-05-29T23:57:28+00:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:20" itemprop="dateModified" datetime="2023-09-24T16:23:20+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ps-and-psd">PS and PSD</h2>
<p>The spectral density format is appropriate for random or noise
signals but inappropriate for discrete frequency components because the
latter theoretically have zero bandwidth</p>
<h2 id="incoherent-and-coherent-power-gains">Incoherent and Coherent
Power Gains</h2>
<p>The incoherent and coherent power gains of these windows are the
appropriate respective correction factors for a power spectral density
plot showing noise and a power spectral plot showing discrete
signals</p>
<h2 id="picket-fence-effect">picket-fence effect</h2>
<h2 id="effective-noise-bandwidth-enbw">Effective Noise BandWidth
(ENBW)</h2>
<h3 id="general-derivation">General derivation</h3>
<p>The relationship between a <em>power spectrum</em> (<span
class="math inline">\(PS, V^2\)</span>) and a <em>power spectral
density</em> (<span class="math inline">\(PSD, V^2/Hz\)</span>) is given
by the <strong>effective noise bandwidth</strong> (<em>ENBW</em>), which
can easily be determined at the time when the DFT is computed.</p>
<p>ENBW should always be recorded when a spectrum or spectral density is
computed, such that the result can be converted to the other form at a
later stage, when the information about the frequency resolution <span
class="math inline">\(f_{res}\)</span> and the window that was used is
normally not easily available any more.</p>
<p>The <strong>normalized equivalent noise bandwidth</strong> (NENBW) of
the window is given by</p>
<p><span class="math display">\[
\text{NENBW} = N\frac{S_2}{S_1}
\]</span> where <span class="math inline">\(S_1 = \sum
_{k=0}^{N-1}w_k\)</span> and <span class="math inline">\(S_2 = \sum
_{k=0}^{N-1}w_k^2\)</span></p>
<p>The <em>ENBW</em> is given by</p>
<p><span class="math display">\[
\text{ENBW} = \text{NENBW}\cdot f_{res} = \text{NENBW}\cdot
\frac{f_s}{N} = f_s\frac{S_2}{(S_1)^2}
\]</span></p>
<blockquote>
<p>Equivalent noise bandwidth (ENBW) compares a <em>window</em> to an
<em>ideal, rectangular time-window</em>. It is the <em>bandwidth of the
rectangular window's frequency-domain shape</em> that passes the same
amount of <strong>white noise</strong> energy as the frequency-domain
shape defined by the other window.</p>
</blockquote>
<p><img src="/2023/05/29/enbw-nl/enbw.png" alt="enbw" /></p>
<p>Therefore, the equivalent noise bandwidth <span
class="math inline">\(B_{enbw}\)</span> is given by</p>
<p><span class="math display">\[
B_{enbw} = \frac{\int_{-f}^{f} |W(f)|^2 df}{|W(f_0)|^2}
\]</span></p>
<p>Translating to discrete domain, the equivalent noise bandwidth can be
computed using DFT samples as</p>
<p><span class="math display">\[
B_{enbw} =\frac{\sum_{k=0}^{N-1}|W[k]|^2}{|W[k_0]|^2}
\]</span></p>
<p>where <span class="math inline">\(k_0\)</span> is the index at which
the magnitude of FFT output is maximum and <span
class="math inline">\(N\)</span> is the window length, i.e. <span
class="math inline">\(k_0=0\)</span>.</p>
<p>Applying <em>Parseval's theorem</em> and <span
class="math inline">\(W[0]=\sum_{n}w[n]\)</span>, <span
class="math inline">\(B_{enbw}\)</span> can also be computed using time
domain samples as</p>
<p><span class="math display">\[
B_{enbw} = N \frac{\sum_{n}|w[n]|^2}{ \left| \sum_{n} w[n] \right|^2}
\]</span></p>
<blockquote>
<p>scale <span class="math inline">\(w[n]\)</span>
<strong>don't</strong> change <span
class="math inline">\(B_{enbw}\)</span></p>
</blockquote>
<h3 id="an-alternative-derivation">An alternative derivation</h3>
<p><img src="/2023/05/29/enbw-nl/coherence-incoherence.drawio.svg"
alt="coherence-incoherence.drawio.svg" /></p>
<p>Assuming the windowed sequence <span class="math inline">\(v[n] =
x[n]w[n]\)</span></p>
<ul>
<li><p><span class="math inline">\(W[k]\)</span>: Fourier Transform of
finite sequence window</p></li>
<li><p><span class="math inline">\(X_{sig}\)</span>: Fourier Transform
of signal</p></li>
<li><p><span class="math inline">\(X_{n}\)</span>: Fourier Transform of
noise</p></li>
<li><p><span class="math inline">\(X_{v,sig}\)</span>: Fourier Transform
of windowed signal</p></li>
<li><p><span class="math inline">\(X_{v,n}\)</span>: Fourier Transform
of windowed signal</p></li>
</ul>
<p>The Fourier Transform of windowed signal can be expressed as</p>
<p><span class="math display">\[\begin{align}
X_{v,sig} &amp;= W_{max}\cdot X_{sig} \\
&amp;= W[0]\cdot X_{sig}
\end{align}\]</span></p>
<blockquote>
<p>For a typical window, <span class="math inline">\(W_{max}\)</span>
occurs at <span class="math inline">\(\omega = 0\)</span></p>
</blockquote>
<p>And the Frouier Transform of windowed noise can be expressed as</p>
<p><span class="math display">\[\begin{align}
X_{v,n}^2 &amp;= \sum_k (W[k])^2 \cdot X_n^2
\end{align}\]</span></p>
<p>divided by <span class="math inline">\((W[0])^2\)</span> on both
sides of the above equation</p>
<p><span class="math display">\[
\frac{X_{v,n}^2}{(W[0])^2} = \frac{\sum_k (W[k])^2}{(W[0])^2} \cdot
X_n^2
\]</span></p>
<p>By Parseval's theorem</p>
<p><span class="math display">\[
\frac{X_{v,n}^2}{\left(\sum_n w[n]\right)^2} = \frac{N\sum_n
w^2[n]}{\left(\sum_n w[n]\right)^2} \cdot X_n^2
\]</span></p>
<p>where <span class="math inline">\(X^2_n\)</span> is what is deserved
and</p>
<p><span class="math display">\[
X_n^2 = \frac{PS_{n}}{B_{enbw}}
\]</span></p>
<p>where <span class="math inline">\(B_{enbw} = N
\frac{\sum_{n}|w[n]|^2}{ \left| \sum_{n} w[n] \right|^2}\)</span></p>
<h3 id="code-example">code example</h3>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">lw = <span class="number">128</span>;</span><br><span class="line">win = hann(lw);</span><br><span class="line">lt = <span class="number">2048</span>;</span><br><span class="line">windft = fftshift(fft(win,lt));</span><br><span class="line"></span><br><span class="line">ad = <span class="built_in">abs</span>(windft).^<span class="number">2</span>;</span><br><span class="line">mg = <span class="built_in">max</span>(ad);</span><br><span class="line"></span><br><span class="line">fs = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">bw = enbw(win,fs);</span><br><span class="line"></span><br><span class="line">bdef = sum((win).^<span class="number">2</span>)/sum(win)^<span class="number">2</span>*fs;</span><br><span class="line">fprintf(<span class="string">&quot;bw: %.3f\n&quot;</span>, bw);</span><br><span class="line">fprintf(<span class="string">&quot;bdef: %.3f\n&quot;</span>, bdef);</span><br><span class="line"></span><br><span class="line">freq = -fs/<span class="number">2</span>:fs/lt:fs/<span class="number">2</span>-fs/lt;</span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(freq,ad, bw/<span class="number">2</span>*[<span class="number">-1</span> <span class="number">-1</span> <span class="number">1</span> <span class="number">1</span>],mg*[<span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span>],<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">xlim(bw*[<span class="number">-1</span> <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">Adiff = trapz(freq,ad)-bw*mg;</span><br><span class="line">fprintf(<span class="string">&quot;Adiff: %.3e\n&quot;</span>, Adiff);</span><br></pre></td></tr></table></figure>
<p>Verify that the area of the rectangle contains the same total power
as the window. <figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Adiff = trapz(freq,ad)-bw*mg</span><br></pre></td></tr></table></figure> output: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bw: 11.811</span><br><span class="line">bdef: 11.811</span><br><span class="line">Adiff: 7.276e-12</span><br></pre></td></tr></table></figure></p>
<p><img src="/2023/05/29/enbw-nl/image-20230530230434715.png"
alt="image-20230530230434715" /></p>
<h2 id="noise-floor">noise floor</h2>
<p><strong>processing gain</strong>:</p>
<p>DFT can pull signals out of background noise. This is due to the
inherent <em>correlation gain</em> that takes place in any N-point
DFT.</p>
<h3 id="assuming-rect-window-is-used">assuming rect window is used</h3>
<p>DFT bin's output <em>noise</em> standard deviation (<em>rms</em>)
value is proportional to <span class="math inline">\(\sqrt{N}\)</span>,
and the DFT's output magnitude for the bin containing the <em>signal
tone</em> is proportional to <span class="math inline">\(N\)</span></p>
<p>signal tone power <span class="math display">\[
P_{\text{sig}} = 2 \frac{X_{sig}^2}{N^2}
\]</span></p>
<blockquote>
<p>+/- frequency spectrum and apply Parseval's theorem</p>
</blockquote>
<p>noise power <span class="math display">\[\begin{align}
P_n &amp;= \sum_{k=0}^{N-1}{\frac{(X_{n}(k))^2}{N^2}}  \\
&amp;= \frac{X_{n}^2}{N^2}\cdot N \\
&amp;= \frac{X_{n}^2}{N}
\end{align}\]</span></p>
<blockquote>
<p>note white noise, that is <span class="math inline">\(X_n(i) =
X_n(j)\)</span></p>
</blockquote>
<p>displayed <strong>SNR</strong> <span
class="math display">\[\begin{align}
\text{SNR} &amp;= 10\log10\left(\frac{X_{sig}^2}{X_{n}^2}\right) \\
&amp;= 10\log_{10}\left(\frac{P_{\text{sig}}N^2}{P_n2N}\right) \\
&amp;= 10\log_{10}\left(\frac{P_{\text{sig}}}{P_n}\right) +
10\log_{10}\left(\frac{N}{2}\right) \\
&amp;= \text{SNR}&#39; + 10\log_{10}(N/2)
\end{align}\]</span></p>
<p>If we increase a DFT's size from <span
class="math inline">\(N\)</span> to <span
class="math inline">\(2N\)</span>, the DFT's output SNR increased by
3dB. So we say that a DFT's <strong>processing gain</strong> increases
by 3dB whenever <span class="math inline">\(N\)</span> is doubled.</p>
<h3 id="general-formula">general formula</h3>
<p>signal tone power <span class="math display">\[
P_{\text{sig}} = 2 \frac{X_{sig}^2}{S_1^2}
\]</span></p>
<p>noise power <span class="math display">\[
P_n = \frac{X_{n}^2}{S_2}
\]</span></p>
<p>Then, displayed <strong>SNR</strong> is obtained <span
class="math display">\[
\text{SNR} = \text{SNR}&#39;+10\log_{10}\left(\frac{S_1^2}{2S_2}\right)
\]</span></p>
<h2 id="amplitude-correction">Amplitude Correction</h2>
<ol type="1">
<li><p>A finite-duration window <span
class="math inline">\(w[n]\)</span></p>
<p>DTFT is <span class="math inline">\(W[e^{j\omega}]\)</span> and the
maximum magnitude is is at DC frequency, which <span
class="math inline">\(\sum_n w_n\)</span></p></li>
<li><p>Sinusoidal signal <span class="math inline">\(x[n]\)</span></p>
<p>DFS is <span class="math inline">\(X_k\)</span>, and DTFT shall be
<span
class="math inline">\(\frac{2\pi}{N}X_k(e^{j\omega})\)</span></p></li>
<li><p>the windowed sequence <span class="math inline">\(v[n] =
x[n]w[n]\)</span></p>
<p>with multiplication property, DTFT of <span
class="math inline">\(v[n]\)</span> shall be <span
class="math inline">\(\frac{X_k(e^{j\omega})}{N}\sum_n w_n\)</span></p>
<p>As we know, DFT of <span class="math inline">\(v[n]\)</span> is
samples of its DTFT, that is <span class="math display">\[
\frac{X_k(e^{j\omega})}{N}\sum_n w_n = X_v[k]
\]</span> Therefore, <span class="math display">\[
\frac{X_k(e^{j\omega})}{N} = \frac{X_v[k]}{\sum_n w_n}
\]</span></p></li>
</ol>
<h2 id="demo">demo</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%https://aaronscher.com/Course_materials/Communication_Systems/documents/PSD_Autocorrelation_Noise.pdf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%Clear variables. clear command window, close all figures:</span></span><br><span class="line">clc;</span><br><span class="line">clear all;</span><br><span class="line">close all;</span><br><span class="line"><span class="comment">%%%Setup and define variables</span></span><br><span class="line">f0=<span class="number">10</span>; <span class="comment">%frequency of sinusoidal signal (Hz)</span></span><br><span class="line">fs=<span class="number">100</span>; <span class="comment">%sampling frequency (Hz)</span></span><br><span class="line">Ts=<span class="number">1</span>/fs; <span class="comment">%sampling period (seconds)</span></span><br><span class="line">N0=<span class="number">3000</span>; <span class="comment">%number of samples</span></span><br><span class="line">t=[<span class="number">0</span>:Ts:Ts*(N0<span class="number">-1</span>)]; <span class="comment">%Sample times</span></span><br><span class="line">noise_PSD=<span class="number">.5</span>; <span class="comment">%This is the desired noise power spectral density in W/Hz.</span></span><br><span class="line">variance=noise_PSD*fs;<span class="comment">% Variance = sigma^2</span></span><br><span class="line">sigma=<span class="built_in">sqrt</span>(variance);</span><br><span class="line">noise=transpose(sigma*<span class="built_in">randn</span>(N0,<span class="number">1</span>));<span class="comment">%create sampled white Gaussian noise.</span></span><br><span class="line">xsignal=<span class="number">20</span>*<span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f0*t); <span class="comment">%create sampled sinusoidal signal</span></span><br><span class="line">x=xsignal+noise; <span class="comment">%Add signal to noise</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line">histogram(noise,<span class="number">30</span>) <span class="comment">%plot histogram</span></span><br><span class="line">set(gca,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">14</span>) <span class="comment">%set font size of axis tick labels to 18</span></span><br><span class="line">xlabel(<span class="string">&#x27;Noise amplitude&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;Frequency of occurance&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Simulated histogram of white Gaussian noise&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">SNR_try1=snr(xsignal,noise); <span class="comment">%calculate SNR using built in &quot;snr&quot; function.</span></span><br><span class="line">SNR_try2=<span class="number">10</span>*<span class="built_in">log10</span>(sum(xsignal.^<span class="number">2</span>)/sum(noise.^<span class="number">2</span>)); <span class="comment">%manually calculate SNR.</span></span><br><span class="line"><span class="comment">%If everything is correct, the two SNR calculations above should agree.</span></span><br><span class="line"><span class="comment">%Plot noise in time-domain</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x)</span><br><span class="line">set(gca,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">14</span>) <span class="comment">%set font size of axis tick labels to 18</span></span><br><span class="line">xlabel(<span class="string">&#x27;Time (s)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;Amplitude&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Noisey sinusoid&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">grid on</span><br><span class="line"><span class="comment">%Plot power spectral density (PSD) of noise using three different methods:</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">%Method 1. Calcululate PSD from amplitude spectrum</span></span><br><span class="line">N=<span class="number">2</span>^<span class="number">16</span>; <span class="comment">%Number of discrete points in the FFT.)</span></span><br><span class="line">y=fft(x,N)/fs; <span class="comment">%fft of noise</span></span><br><span class="line">z=fftshift(y);<span class="comment">%center noise spectrum</span></span><br><span class="line">f_vec=[<span class="number">0</span>:<span class="number">1</span>:N<span class="number">-1</span>]*fs/N-fs/<span class="number">2</span>; <span class="comment">%designate sample frequencies</span></span><br><span class="line">amplitude_spectrum=<span class="built_in">abs</span>(z); <span class="comment">%compute two-sided amplitude spectrum</span></span><br><span class="line">ESD1=amplitude_spectrum.^<span class="number">2</span>; <span class="comment">%ESD = |F(w)|^2;</span></span><br><span class="line">PSD1=ESD1/((N0<span class="number">-1</span>)*Ts);<span class="comment">% PSD=ESD/T where T = total time of sample</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(f_vec,<span class="number">10</span>*<span class="built_in">log10</span>(PSD1));</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency [Hz]&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;dB/Hz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Power spectral density - method 1&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">grid on</span><br><span class="line">set(gcf,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;w&#x27;</span>); <span class="comment">%set background color from grey (default) to white</span></span><br><span class="line">axis tight</span><br><span class="line"><span class="comment">%calculate average power using PSD calclated from method 1:</span></span><br><span class="line">Average_power_method_1=sum(PSD1)*fs/N; <span class="comment">% Pav=sum(PSD)*delta_f where delta_f=fs/N;</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">%Method 2 - Calculate PSD from autocorrelation</span></span><br><span class="line">time_lag=((-<span class="built_in">length</span>(x)+<span class="number">1</span>):<span class="number">1</span>:(<span class="built_in">length</span>(x)<span class="number">-1</span>))*Ts;</span><br><span class="line">auto_cor=xcorr(x,x)/fs; <span class="comment">%Use xcorr function to find PSD</span></span><br><span class="line">y=<span class="number">1</span>/fs*fft(auto_cor,N); <span class="comment">%fft of auto correlation function</span></span><br><span class="line">PSD2=<span class="built_in">abs</span>(<span class="number">1</span>/(N0<span class="number">-1</span>)*fftshift(fft(auto_cor,N)));</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">plot</span>(f_vec,<span class="number">10</span>*<span class="built_in">log10</span>(PSD2));<span class="comment">%use convolution</span></span><br><span class="line">xlabel(<span class="string">&#x27;Frequency [Hz]&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;dB/Hz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Power spectral density - method 2&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">grid on</span><br><span class="line">set(gcf,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;w&#x27;</span>); <span class="comment">%set background color from grey (default) to white</span></span><br><span class="line">axis tight</span><br><span class="line"><span class="comment">%calculate average power using PSD calclated from method 1:</span></span><br><span class="line">Average_power_method_2=sum(PSD2)*fs/N; <span class="comment">%Pav=sum(PSD)*delta_f where delta_f=fs/N;</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">%Method 3 - Calculate PSD using built in pwelch function</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">5</span>)</span><br><span class="line">PSD3=periodogram(x,[],N,fs,<span class="string">&#x27;centered&#x27;</span>);</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">10</span>*<span class="built_in">log10</span>(PSD3))</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency [Hz]&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;dB/Hz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Power spectral density - method 3&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">grid on</span><br><span class="line">set(gcf,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;w&#x27;</span>); <span class="comment">%set background color from grey (default) to white</span></span><br><span class="line">axis tight</span><br><span class="line">Average_power_method_3=sum(PSD3)*fs/N; <span class="comment">%Pav=sum(PSD)*delta_f where delta_f=fs/N;</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">%Calculate mean and average PSD of noise:</span></span><br><span class="line">PSD_noise=periodogram(noise,[],N,fs,<span class="string">&#x27;centered&#x27;</span>);</span><br><span class="line">Average_noise_PSD=<span class="built_in">mean</span>(PSD_noise);</span><br><span class="line">Mean_noise=<span class="built_in">mean</span>(noise);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/29/enbw-nl/image-20230531004822838.png"
alt="image-20230531004822838" /></p>
<p><img src="/2023/05/29/enbw-nl/image-20230531005008418.png"
alt="image-20230531005008418" /></p>
<blockquote>
<p>The power spectral density plots for methods 2 and 3 exactly match
that for method 1 (shown above).</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Schmid, H. (2012). How to use the FFT and Matlab's pwelch function
for signal and noise simulations and measurements. URL:<a
target="_blank" rel="noopener" href="http://www.schmid-werren.ch/hanspeter/publications/2012fftnoise.pdf">http://www.schmid-werren.ch/hanspeter/publications/2012fftnoise.pdf</a></p>
<p>Bonnie C.Baker. Reading and Using Fast Fourier Transforms (FFT)
URL:<a
target="_blank" rel="noopener" href="http://ww1.microchip.com/downloads/en/appnotes/00681a.pdf">http://ww1.microchip.com/downloads/en/appnotes/00681a.pdf</a></p>
<p>FFT analysis: SNR and Noise level vary with FFT Window size URL:<a
target="_blank" rel="noopener" href="https://www.virtins.com/forum/viewtopic.php?f=7&amp;t=1382">https://www.virtins.com/forum/viewtopic.php?f=7&amp;t=1382</a></p>
<p>Lyons, R. G. (2011). Understanding digital signal processing (3rd
ed.). Prentice Hall</p>
<p>Stefan Scholl, "Exact Signal Measurements using FFT
Analysis",Microelectronic Systems Design Research Group, TU
Kaiserslautern, Germany. [<a
target="_blank" rel="noopener" href="https://kluedo.ub.rptu.de/frontdoor/deliver/index/docId/4293/file/exact_fft_measurements.pdf">pdf</a>]</p>
<p>enbw Matlab URL:<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ref/enbw.html">https://www.mathworks.com/help/signal/ref/enbw.html</a></p>
<p>Aaron Scher. PSD, Autocorrelation, and Noise in MATLAB [<a
target="_blank" rel="noopener" href="https://aaronscher.com/Course_materials/Communication_Systems/documents/PSD_Autocorrelation_Noise.pdf">pdf</a>]</p>
<p>Aaron Scher. FFT, total energy, and energy spectral density
computations in MATLAB [<a
target="_blank" rel="noopener" href="https://aaronscher.com/Course_materials/Communication_Systems/documents/Energy_signals_matlab_tutorial.pdf">pdf</a>]</p>
<p>Amplitude Estimation and Zero Padding URL:<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ug/amplitude-estimation-and-zero-padding.html">https://www.mathworks.com/help/signal/ug/amplitude-estimation-and-zero-padding.html</a></p>
<p>Harris, F. (1978). On the use of windows for harmonic analysis with
the discrete Fourier transform. Proceedings of the IEEE, 66, 51-83. [<a
target="_blank" rel="noopener" href="https://www.fceia.unr.edu.ar/prodivoz/Harris_1978.pdf">pdf</a>]</p>
<p>Harris, F. J. . (1976). Windows, harmonic analysis and the discrete
fourier transform. [<a
target="_blank" rel="noopener" href="https://apps.dtic.mil/sti/pdfs/ADA034956.pdf">pdf</a>]</p>
<p>Wang Hongwei. Virtins. Evaluation of Various Window Functions using
Multi-Instrument [<a
target="_blank" rel="noopener" href="https://www.virtins.com/doc/D1003/Evaluation_of_Various_Window_Functions_using_Multi-Instrument_D1003.pdf">pdf</a>]</p>
<p>Properties of FFT Windows Used in Stable32 [<a
target="_blank" rel="noopener" href="http://www.wriley.com/Properties%20of%20FFT%20Windows%20Used%20in%20Stable32.pdf">pdf</a>]</p>
<p>Solomon, Jr, O M. PSD computations using Welch's method. [Power
Spectral Density (PSD)]. United States. https://doi.org/10.2172/5688766
[<a target="_blank" rel="noopener" href="https://www.osti.gov/servlets/purl/5688766">pdf</a>]</p>
<p>Measure Power of Deterministic Periodic Signals [<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ug/measuring-the-power-of-deterministic-periodic-signals.html">link</a>]</p>
<p>Mathuranathan. Equivalent noise bandwidth (ENBW) of window functions.
[<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2020/09/equivalent-noise-bandwidth-enbw-of-window-functions/">link</a>]</p>
<p>recordingblogs, Equivalent noise bandwidth [<a
target="_blank" rel="noopener" href="https://www.recordingblogs.com/wiki/equivalent-noise-bandwidth">link</a>]</p>
<p>unpingco, Python for Signal Processing [<a
target="_blank" rel="noopener" href="https://github.com/unpingco/Python-for-Signal-Processing/blob/master/Windowing_Part2.ipynb">lnk</a>]</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/29/dnw/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/29/dnw/" class="post-title-link" itemprop="url">Impact of Deep N-well Implantation</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-29 00:00:26" itemprop="dateCreated datePublished" datetime="2023-05-29T00:00:26+00:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:20" itemprop="dateModified" datetime="2023-09-24T16:23:20+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="substrate-noise">Substrate noise</h2>
<p>A variety of techniques can be used to minimize this noise, for
example by keeping analog devices surrounded by guard rings, or using a
separate supply for the substrate/well taps.</p>
<p>However <em>guard rings alone cannot prevent noise coupling deep in
the substrate, only surface currents</em>.</p>
<blockquote>
<p>PMOS are less noisy than NMOS since PMOS has its nwell which isolates
the substrate noise, but such is not valid for NMOS .</p>
</blockquote>
<h2 id="dnw">DNW</h2>
<p>The N-channel devices built directly into the P-type substrate are
not as effectively isolated as P-channel devices in their N-wells. This
is because despite creating a P+ guard ring around the devices, there
remains an electrical path below the guard ring for charge to flow.</p>
<p>To overcome this issue, a <em>deep N-well</em> can be used to more
effectively isolate these N-channel devices.</p>
<p><img src="/2023/05/29/dnw/image-20230529001556060.png"
alt="image-20230529001556060" /></p>
<p><img src="/2023/05/29/dnw/image-20230529010836003.png"
alt="image-20230529010836003" /></p>
<p><img src="/2023/05/29/dnw/BM_SS_Fig1-520x288.jpg"
alt="BM_SS_Together at Last_Fig1" /></p>
<blockquote>
<p><a
target="_blank" rel="noopener" href="https://blogs.sw.siemens.com/calibre/2015/11/03/together-at-last-combining-netlist-and-layout-data-for-power-aware-verification/">Together
At Last â€“ Combining Netlist and Layout Data for Power-Aware
Verification</a></p>
</blockquote>
<p><img src="/2023/05/29/dnw/image-20230529002733114.png"
alt="image-20230529002733114" /></p>
<ul>
<li>the P-well is separated, allowing the voltage to be controlled</li>
<li>because the circuit within the deep N-well is separated from the
p-substrate in this structure, there is the benefit that this circuitry
is less susceptible to noise that propagates through the
p-substrate.</li>
</ul>
<h2 id="reference">reference</h2>
<p>Chew, K.W., Zhang, J., Shao, K., Loh, W., &amp; Chu, S.F. (2002).
Impact of Deep N-well Implantation on Substrate Noise Coupling and RF
Transistor Performance for Systems-on-a-Chip Integration. 32nd European
Solid-State Device Research Conference, 251-254. URL:[<a
target="_blank" rel="noopener" href="http://www.essderc2002.deis.unibo.it/ESSDERC_web/Session_D11/D11_1.pdf">slides</a>,
<a
target="_blank" rel="noopener" href="http://www.essderc2002.deis.unibo.it/data/pdf/Chew.pdf">paper</a>]</p>
<p>Mark Waller, <a
target="_blank" rel="noopener" href="https://www.planetanalog.com/analog-layout-why-wells-taps-and-guard-rings-are-crucial/">Analog
layout: Why wells, taps, and guard rings are crucial</a></p>
<p>KEITH SABINE <a
target="_blank" rel="noopener" href="https://www.planetanalog.com/using-deep-n-wells-in-analog-design/">Using
Deep N Wells in Analog Design</a></p>
<p>Faricelli, J. (2010). Layout-dependent proximity effects in deep
nanoscale CMOS. IEEE Custom Integrated Circuits Conference 2010,
1-8.</p>
<p>cmos_processing, URL:<a
target="_blank" rel="noopener" href="http://users.ece.utexas.edu/~athomsen/cmos_processing.pdf">http://users.ece.utexas.edu/~athomsen/cmos_processing.pdf</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/27/laplace-z/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/27/laplace-z/" class="post-title-link" itemprop="url">System Analysis Using Laplace Transform and z-Transform</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-27 14:37:03" itemprop="dateCreated datePublished" datetime="2023-05-27T14:37:03+00:00">2023-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:21" itemprop="dateModified" datetime="2023-09-24T16:23:21+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="reference">reference</h2>
<p>Lathi, B. P., &amp; Green, R. A. (2018). Linear systems and signals
(Third Edition.). Oxford University Press.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/27/dtft-dft/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/27/dtft-dft/" class="post-title-link" itemprop="url">Discrete Time Fourier Transform (DTFT) vs Discrete Fourier Transform (DFT)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-27 10:59:52" itemprop="dateCreated datePublished" datetime="2023-05-27T10:59:52+00:00">2023-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:20" itemprop="dateModified" datetime="2023-09-24T16:23:20+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="sampling-theorem">sampling theorem</h2>
<h3 id="time-sampling-theorem">time-sampling theorem</h3>
<p><img src="/2023/05/27/dtft-dft/image-20230527154334304.png"
alt="image-20230527154334304" /></p>
<p>The spectrum <span
class="math inline">\(\overline{X}(\omega)\)</span> consists of <span
class="math inline">\(X(\omega)\)</span> repeating periodically with
period <span class="math inline">\(\omega _s = 2\pi/T\)</span> rad/s, or
<span class="math inline">\(f_s = 1/T\)</span> Hz <span
class="math display">\[
\overline{X}(\omega) = \frac{1}{T}\sum_{n=-\infty}^{\infty}X(\omega -
n\omega _s)
\]</span></p>
<h3 id="spectral-sampling-theorem">spectral-sampling theorem</h3>
<p><img src="/2023/05/27/dtft-dft/image-20230527155436179.png"
alt="image-20230527155436179" /></p>
<p>The Fourier transform <span class="math inline">\(X(\omega)\)</span>
of a <strong>timelimited</strong> signal <span
class="math inline">\(x(t)\)</span> is given by <span
class="math display">\[
X(\omega)=\int_{-\infty}^{\infty}x(t)e^{-j\omega t}dt =
\int_0^{\tau}x(t)e^{-j\omega t}dt
\]</span> <span class="math inline">\(x_{T_0}(t)\)</span>, a
<strong>periodic</strong> signal formed by repeating <span
class="math inline">\(x(t)\)</span> every <span
class="math inline">\(T_0\)</span> seconds (<span
class="math inline">\(T_0 \gt \tau\)</span>), which can be expressed by
the exponential Fourier series <span class="math display">\[
x_{T_0}(t) = \sum_{-\infty}^{\infty}D_ne^{jn\omega _0t}
\]</span> where <span class="math inline">\(\omega_0 =
\frac{2\pi}{T_0}\)</span></p>
<p>And <span class="math inline">\(D_n\)</span> can be obtained by
(assuming <span class="math inline">\(T_0 \gt \tau\)</span>) <span
class="math display">\[
D_n = \frac{1}{T_0}\int_0^{T_0}x(t)e^{-jn\omega _0 t}dt =
\frac{1}{T_0}\int_0^{\tau}x(t)e^{-jn\omega _0 t}dt
\]</span> Then it follows that <span class="math display">\[
D_n = \frac{1}{T_0}X(n\omega _0)
\]</span> This result indicates that the <em>coefficients of the Fourier
series</em> for <span class="math inline">\(x_{T_0}(t)\)</span> are
<span class="math inline">\((1/T_0)\)</span> times the <em>sample values
of the spectrum</em> <span class="math inline">\(X(\omega)\)</span>
taken at intervals of <span class="math inline">\(\omega
_0\)</span>.</p>
<h4 id="spectral-interpolation">spectral interpolation</h4>
<p>Consider a signal <em>timelimited</em> to <span
class="math inline">\(\tau\)</span> seconds and <em>centered at</em>
<span class="math inline">\(T_c\)</span>. The spectrum <span
class="math inline">\(X(\omega)\)</span> of <span
class="math inline">\(x(t)\)</span> can be reconstructed from the
samples of <span class="math inline">\(X(\omega)\)</span> and the
<strong>spectral interpolation formula</strong> is obtained as <span
class="math display">\[
X(\omega) = \sum_{-\infty}^{\infty}X(n\omega _0)
\text{sinc}\left(\frac{\omega T_0}{2}-n\pi\right)e^{-j(\omega - n\omega
_0)T_c}
\]</span> step by step:</p>
<ol type="1">
<li><p>The Fourier transform of <span
class="math inline">\(x_{T_0}(t)\)</span> is <span
class="math display">\[
2\pi\sum_n D_n \delta(\omega - n\omega_0) = \frac{2\pi}{T_0}\sum_n
X(n\omega_0) \delta(\omega - n\omega_0)
\]</span></p></li>
<li><p>The Fourier transform of rectangular pulse <span
class="math inline">\(\text{rect}((t-T_c)/T_0)\)</span> centered at
<span class="math inline">\(T_c\)</span> and duration <span
class="math inline">\(T_0\)</span> <span class="math display">\[
T_0 \text{sinc}(\omega T_0/2)e^{-j\omega T_c}
\]</span></p></li>
<li><p>Hence, <span class="math inline">\(X(\omega)\)</span> is <span
class="math inline">\(1/2\pi\)</span> times the <em>convolution</em> of
these two Fourier</p></li>
</ol>
<h2 id="numerical-computation-of-the-fourier-transform">Numerical
Computation of The Fourier Transform</h2>
<h3 id="aliasing-and-leakage-in-numerical-computation">aliasing and
leakage in numerical computation</h3>
<ol type="1">
<li><p><em>timelimited</em> <span
class="math inline">\(x(t)\)</span></p>
<p>its spectrum <span class="math inline">\(X(\omega)\)</span> is
nonbandlimited - aliasing in the frequency domain</p></li>
<li><p><span class="math inline">\(x(t)\)</span> with
<em>bandlimited</em> spectrum <span
class="math inline">\(X(\omega)\)</span></p>
<p>no aliasing in the spectrum; such a signal is nontimelimited and
aliasing in the time domian</p></li>
</ol>
<h3 id="dfs---representation-of-periodic-sequences">DFS - representation
of periodic sequences</h3>
<p>also known as <strong>discrete-time Fouier series (DTFS)</strong></p>
<blockquote>
<p>Any <em>periodic sequence</em> can be represented as <em>a sum of
complex exponential sequences</em>.</p>
</blockquote>
<p>â­Analysis equation <span class="math display">\[
\tilde{X}[k] = \sum_{n=0}^{N-1}\tilde{x}[n]W_N^{kn}
\]</span> where <span class="math inline">\(W_N =
e^{-j(2\pi/N)}\)</span></p>
<p>â­Synthesis equation <span class="math display">\[
\tilde{x}[n] = \frac{1}{N}\sum_{k=0}^{N-1}\tilde{X}[k]W_N^{-kn}
\]</span></p>
<blockquote>
<p>The multiplicative constant <span class="math inline">\(1/N\)</span>
is included in above equation for convenience. It could also be absorbed
into the definition of <span
class="math inline">\(\tilde{X}[k]\)</span></p>
</blockquote>
<p>In general <span class="math display">\[
W_N^{n+lN} = e^{-j(2\pi/N)(n+lN)} =e^{-j(2\pi/N)n}=W_N^n
\]</span> The Fourier series coefficients <span
class="math inline">\(\tilde{X}[k]\)</span> can be interpreted to be</p>
<ul>
<li>a sequence of finite length, for <span
class="math inline">\(k=0,...,(N-1)\)</span>, and zero otherwise</li>
<li>a periodic sequence defined for all <span
class="math inline">\(k\)</span>, with period <span
class="math inline">\(N\)</span></li>
</ul>
<p>Clearly, both of these interpretations are acceptable, since in
<em>Synthesis equation</em> we use only the values of</p>
<p><span class="math inline">\(\tilde{X}[k]\)</span> for <span
class="math inline">\(0 \leq k \leq (N-1)\)</span>.</p>
<p>An advantage to interpreting the Fourier series coefficients <span
class="math inline">\(\tilde{X}[k]\)</span> as a periodic sequence is
that there is then a <em>duality</em> between the time and frequency
domains for the Fourier series representation of periodic sequences.</p>
<h4 id="duality">Duality</h4>
<p>An exact duality exists between the time and frequency domains in the
DFS representation that does not exist in the DTFT and z-transform
representation of sequences</p>
<p>This duality property is summarized as follows:</p>
<p>If <span class="math display">\[
\tilde{x}[n] \overset{DFS}\longleftrightarrow \tilde{X}[k]
\]</span> then <span class="math display">\[
\tilde{X}[n] \overset{DFS}\longleftrightarrow N\tilde{x}[-k]
\]</span></p>
<h3 id="the-fourier-transform-of-periodic-signals">The Fourier Transform
of Periodic Signals</h3>
<p>use the DFS representation to obtain a DTFT representation of
periodic signal:</p>
<ol type="1">
<li><p><em>uniform convergence</em> of the Fourier transform of a
sequence (<em>DTFT</em>) requires that the sequence be <em>absolutely
summable</em>, and <em>mean-square convergence</em> requires that the
sequence be <em>square summable</em>. Periodic sequences <strong>satisfy
neither condition</strong> .</p>
<p><strong>Absolute summability is a sufficient condition</strong> for
the existence of a Fourier transform representation (<em>DTFT</em>)</p>
<p><span class="math display">\[\begin{align}
|X(e^{j\omega})| &amp;= \left| \sum_{n=-\infty}^{\infty}x[n]e^{-j\omega
n} \right| \\
&amp;\leq \sum_{n=-\infty}^{\infty}|x[n]||e^{-j\omega n}| \\
&amp;\leq \sum_{n=-\infty}^{\infty}|x[n]| \lt \infty
\end{align}\]</span></p></li>
<li><p>sequences that can be expressed as a sum of complex exponentials
can be considered to have a Fourier transform representation as a train
of impulses</p></li>
</ol>
<p>â­If <span class="math inline">\(\tilde{x}[n]\)</span> is periodic
with period <span class="math inline">\(N\)</span> and the corresponding
<em>DFS coefficients</em> are <span
class="math inline">\(\tilde{X}[k]\)</span>, then the Fourier transform
of <span class="math inline">\(\tilde{x}[n]\)</span> is defined to be
the <strong>impulse train</strong> <span class="math display">\[
\tilde{X}(e^{j\omega}) =
\sum_{k=-\infty}^{\infty}\frac{2\pi}{N}\tilde{X}[k]\delta\left(\omega -
\frac{2\pi k}{N}\right)
\]</span> Note that <span
class="math inline">\(\tilde{X}(e^{j\omega})\)</span> has the necessary
periodicity with period <span class="math inline">\(2\pi\)</span> since
<span class="math inline">\(\tilde{X}[k]\)</span> is periodic with
period <span class="math inline">\(N\)</span>, and the impulses are
spaced at integer multiples of <span
class="math inline">\(2\pi/N\)</span>, where <span
class="math inline">\(N\)</span> is an integer.</p>
<p>The follow inverse Fourier transform shows <span
class="math inline">\(\tilde{X}(e^{j\omega})\)</span> is a Fourier
transform representation of the periodic sequence <span
class="math inline">\(\tilde{x}[n]\)</span></p>
<p><img src="/2023/05/27/dtft-dft/image-20230528100004194.png"
alt="image-20230528100004194" /></p>
<blockquote>
<p>Although the Fourier transform of a periodic sequence does not
converge in the normal sense, the <strong>introduction of
impulses</strong> (<span class="math inline">\(\delta\left(\omega -
\frac{2\pi k}{N}\right)\)</span>) permits us to include <em>periodic
sequences formally within the framework of Fourier transform
analysis</em></p>
</blockquote>
<h3 id="relate-finite-length-signal-to-periodic-signal">relate
finite-length signal to periodic signal</h3>
<p><img src="/2023/05/27/dtft-dft/image-20230528112723460.png"
alt="image-20230528112723460" /></p>
<blockquote>
<p><span class="math display">\[
x[n] = \left\{ \begin{array}{cl}
\tilde{x}[n] &amp; : \ 0 \leq n \leq N-1 \\
0 &amp; : \text{otherwise}
\end{array} \right.
\]</span></p>
</blockquote>
<p>Consider a finite-length signal <span
class="math inline">\(x[n]\)</span> such that <span
class="math inline">\(x[n] = 0\)</span> except in the interval <span
class="math inline">\(0 \leq n \leq N âˆ’ 1\)</span>, and consider the
convolution of <span class="math inline">\(x[n]\)</span> with the
periodic impulse train <span
class="math inline">\(\tilde{p}[n]\)</span>: <span
class="math display">\[
\tilde{x}[n] = x[n]*\tilde{p}[n] = x[n]*
\sum_{r=-\infty}^{\infty}\delta[n-rN] = \sum_{r=-\infty}^{\infty}x[n-rN]
\]</span> Thanks to Fourier Transform <em>convolution property</em>, the
DTFT of <span class="math inline">\(\tilde{x}[n]\)</span> is
obtained</p>
<p><span class="math display">\[\begin{align}
\tilde{X}(e^{j\omega}) &amp;= X(e^{j\omega}) \tilde{P}(e^{j\omega})\\
&amp;= X(e^{j\omega})
\sum_{k=-\infty}^{\infty}\frac{2\pi}{N}\delta\left(\omega - \frac{2\pi
k}{N}\right) \\
&amp; =
\sum_{k=-\infty}^{\infty}\frac{2\pi}{N}X(e^{j(2\pi/N)k})\delta\left(\omega
- \frac{2\pi k}{N}\right)
\end{align}\]</span></p>
<p>â­Â we conclude the DFS coefficients of <span
class="math inline">\(\tilde{x}[n]\)</span> is <span
class="math display">\[
\tilde{X}[k] = X(e^{j\omega})|_{\omega=2\pi k/N}
\]</span> where <span class="math inline">\(\tilde{X}[k]\)</span> is
<strong>DFS coefficients</strong> of <span
class="math inline">\(\tilde{X}[k]\)</span>;</p>
<p><span class="math inline">\(X(e^{j\omega})|_{\omega=2\pi
k/N}\)</span> is samples of the <strong>DTFT</strong> of the
<em>finite-length sequence</em> <span
class="math inline">\(x[n]\)</span></p>
<h3 id="sampling-the-fourier-transform">sampling the fourier
transform</h3>
<p>Assuming an <em>aperiodic sequence</em> with Fourier transform <span
class="math inline">\(X(e^{j\omega})\)</span>, the <strong>sequences of
samples</strong> <span class="math inline">\(\tilde{X}[k] =
X(e^{j\omega})|_{\omega=2\pi k/N}\)</span> being periodic with period
<span class="math inline">\(N\)</span> could be the <strong>sequence of
<em>DFS</em> coefficients</strong> of sequence <span
class="math inline">\(\tilde{x}[n]\)</span></p>
<p>â­To obtain <span class="math inline">\(\tilde{x}[n]\)</span>,
substitute <span class="math inline">\(\tilde{X}[k]\)</span> into DFS
synthesis equation <span class="math display">\[
\tilde{x}[n] =x[n]*\sum_{r=-\infty}^{\infty}\delta[n-rN] =
\sum_{r=-\infty}^{\infty}x[n-rN]
\]</span> Thus, the periodic sequence <span
class="math inline">\(\tilde{x}[n]\)</span>, corresponding to <span
class="math inline">\(\tilde{X}[k]\)</span> obtained by sampling <span
class="math inline">\(X(e^{j\omega})\)</span>, is formed from <span
class="math inline">\(x[n]\)</span> by <em>adding together an infinite
number of shifted replicas of <span
class="math inline">\(x[n]\)</span></em>.</p>
<h3 id="discrete-fourier-transform-dft">Discrete Fourier Transform
(DFT)</h3>
<blockquote>
<p>When the <strong>Fourier series</strong> is used in this way to
represent <em>finite-length sequences</em>, it is called the discrete
Fourier transform or <strong>DFT</strong></p>
<p>In developing, discussing, and applying the DFT, it is always
important to remember that the representation through <em>samples of the
Fourier transform</em> is in effect <em>a representation of the
finite-duration sequence by a periodic sequence</em>, <strong>one period
of which is the finite duration sequence that we wish to
represent</strong></p>
</blockquote>
<ul>
<li><p>Considering a <em>finite-length</em> sequence <span
class="math inline">\(x[n]\)</span> of length <span
class="math inline">\(N\)</span> samples such that <span
class="math inline">\(x[n]=0\)</span> outside the range <span
class="math inline">\(0\leq n \leq N-1\)</span>.</p>
<p>To each finite-length sequence of length <span
class="math inline">\(N\)</span>, we can always associate a periodic
sequence <span class="math inline">\(\tilde{x}[n]\)</span></p>
<p><span class="math inline">\(\tilde{x}[n] =
\sum_{r=-\infty}^{\infty}x[n-rN]\)</span></p></li>
<li><p>Since <span class="math inline">\(x[n]\)</span> is assumed to
have finite length <span class="math inline">\(N\)</span>, there is
<em>no overlap</em> between the terms <span class="math inline">\(x[n âˆ’
rN]\)</span> for different values of <span
class="math inline">\(r\)</span>.</p>
<p><span class="math inline">\(\tilde{x}[n] = x[(n \; \text{modulo}\;
N)]\)</span></p></li>
</ul>
<p>As discussed the sequence of <em>DFS coefficients</em> <span
class="math inline">\(\tilde{X}[k]\)</span> of <em>the periodic
sequence</em> <span class="math inline">\(\tilde{x}[n]\)</span> is
itself a periodic sequence with <em>period</em> <span
class="math inline">\(N\)</span>.</p>
<p>To maintain a duality between the time and frequency domains, This
finite-duration sequence, <span class="math inline">\(X [k]\)</span>,
one period of <span class="math inline">\(\tilde{X}[k]\)</span> will be
referred to as the <strong>DFT</strong> <span class="math display">\[
X[k] = \left\{ \begin{array}{cl}
\tilde{X}[k] &amp; : \ 0 \leq k \leq N-1 \\
0 &amp; : \ \text{otherwise}
\end{array} \right.
\]</span> and <span class="math display">\[
\tilde{X}[k] = X[(k \; \text{modulo}\; N)]
\]</span> <span class="math inline">\(\tilde{X}[k]\)</span> and <span
class="math inline">\(\tilde{x}[n]\)</span> are related by</p>
<p><span class="math display">\[\begin{align}
\tilde{X}[k] &amp;= \sum_{n=0}^{N-1}\tilde{x}[n]W_N^{kn} \\
\tilde{x}[n] &amp;=\frac{1}{N} \sum_{k=0}^{N-1}\tilde{X}[k]W_N^{-kn}
\end{align}\]</span></p>
<p>where <span class="math inline">\(W_N = e^{-j(2\pi/N)}\)</span></p>
<p>DFT analysis and synthesis equations , <span
class="math inline">\(X[k]\)</span> and <span
class="math inline">\(x[n]\)</span> are related by</p>
<p>â­Â Analysis equation: <span class="math display">\[
X[k] = \left\{ \begin{array}{cl}
\sum_{n=0}^{N-1}x[n]W_N^{kn} &amp; : \ 0 \leq k \leq N-1 \\
0 &amp; : \ \text{otherwise}
\end{array} \right.
\]</span> â­ Synthesis equation: <span class="math display">\[
x[n] = \left\{ \begin{array}{cl}
\frac{1}{N} \sum_{k=0}^{N-1}X[k]W_N^{-kn} &amp; : \ 0 \leq n \leq N-1 \\
0 &amp; : \ \text{otherwise}
\end{array} \right.
\]</span></p>
<blockquote>
<p>That is, the fact that <span class="math inline">\(X[k]=0\)</span>
for <span class="math inline">\(k\)</span> outside the interval <span
class="math inline">\(0 \leq k \leq N âˆ’1\)</span> and that <span
class="math inline">\(x[n] = 0\)</span> for <span
class="math inline">\(n\)</span> outside the interval <span
class="math inline">\(0 \leq n \leq N âˆ’ 1\)</span> is implied, but not
always stated explicitly.</p>
</blockquote>
<blockquote>
<p>The inherent periodicity is always present. Sometimes, it causes us
difficulty, and sometimes we can exploit it, but to totally ignore it is
to invite trouble.</p>
<p>In defining the DFT representation,</p>
<ul>
<li>we are simply recognizing that we are interested in values of <span
class="math inline">\(x[n]\)</span> only in the interval <span
class="math inline">\(0 \leq n \leq N-1\)</span>, because <span
class="math inline">\(x[n]\)</span> is really zero outside that
interval,</li>
<li>and we are interested in values of <span
class="math inline">\(X[k]\)</span> only in the interval <span
class="math inline">\(0 \leq k \leq N-1\)</span> because these are the
only values needed to reconstruct <span
class="math inline">\(x[n]\)</span></li>
</ul>
</blockquote>
<h3 id="multiplication-property-convolution-property">multiplication
property &amp; convolution property</h3>
<p>Because a digital computer can work only with <em>discrete data</em>
(sequence of numbers), moreover, it can compute <span
class="math inline">\(X(\omega)\)</span> only at some <em>discrete
values</em> of <span class="math inline">\(\omega\)</span> (samples of
<span class="math inline">\(X(\omega)\)</span>).</p>
<p><img src="/2023/05/27/dtft-dft/image-20230527181614818.png"
alt="image-20230527181614818" /></p>
<ul>
<li><p><strong>{ (a), (b) } -&gt; { (c), (d) }</strong>:</p>
<p>with CT multiplication property, <span
class="math inline">\(X(\omega) = T
\overline{X}(\omega)\)</span></p></li>
<li><p><strong>{ (c), (d) } -&gt; { (e), (f) }</strong>:</p>
<p>with DT convolution property, <span class="math inline">\(X_N(\omega)
= \frac{2\pi}{N}\overline{X}(\omega)\)</span></p></li>
<li><p>Assuming <span class="math inline">\(x_{T0}(t)
=\sum_{r=-\infty}^{\infty}x(t-rT_0)\)</span>, formed by adding together
an infinite number of shifted replicas of <span
class="math inline">\(x(t)\)</span>: with CT convolution property, <span
class="math inline">\(X_{T0}(\omega)=X(\omega)\frac{2\pi}{T_0}=\overline{X}(\omega)\frac{2\pi
T}{T_0}\)</span> which is <span
class="math inline">\(X_{T0}(\omega)=\frac{2\pi}{N}\overline{X}(\omega)\)</span></p></li>
</ul>
<p><span class="math inline">\(X_N(\omega) = X_{T0}(\omega)\)</span>
indicates that finite-length discrete-time sequence provide Fourier
Transform of continuous-time periodic signal</p>
<p>â­when a signal <span class="math inline">\(x(t)\)</span> is sampled
and then periodically repeated, the corresponding spectrum is also
sampled and periodically repeated</p>
<h2 id="zero-padding">zero-padding</h2>
<h3 id="the-number-of-zero-padding">The number of zero-padding</h3>
<p>When you tack on a bunch of zeros to a sequence and then compute the
<em>DFT</em>, you're just getting <strong>more and more samples</strong>
of the <em>DTFT</em> of the original sequence.</p>
<p>Let's look at a simple rectangular pulse, <span
class="math inline">\(x[n]=1\)</span> for <span class="math inline">\(0
\leq n \lt M\)</span>. The DTFT of <span
class="math inline">\(x[n]\)</span> is: <span class="math display">\[
X(\omega) = \frac{\sin(\omega M/2)}{\sin(\omega/2)} e^{-j \omega
(M-1)/2}
\]</span> Let's plot <span class="math inline">\(|X(\omega)|\)</span>
for <span class="math inline">\(M=8\)</span> over a couple of
periods:</p>
<p><img src="/2023/05/27/dtft-dft/image-20230527210507334.png"
alt="image-20230527210507334" /></p>
<p>Here's the <em>P</em>-point DFT of our 8-point rectangular pulse:</p>
<ul>
<li><p>8-point DFT</p>
<p><img src="/2023/05/27/dtft-dft/image-20230526231448884.png"
alt="image-20230526231448884" /></p></li>
<li><p>16-point DFT</p>
<p><img src="/2023/05/27/dtft-dft/image-20230526231531076.png"
alt="image-20230526231531076" /></p></li>
<li><p>32-point DFT</p>
<p><img src="/2023/05/27/dtft-dft/image-20230526231633067.png"
alt="image-20230526231633067" /></p></li>
</ul>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">clc;</span><br><span class="line">clear all;</span><br><span class="line"></span><br><span class="line">M = <span class="number">8</span>;</span><br><span class="line">w = <span class="built_in">linspace</span>(<span class="number">-2</span>*<span class="built_in">pi</span>, <span class="number">2</span>*<span class="built_in">pi</span>, <span class="number">800</span>);</span><br><span class="line">X_dtft = (<span class="built_in">sin</span>(w*M/<span class="number">2</span>) ./ <span class="built_in">sin</span>(w/<span class="number">2</span>)) .* <span class="built_in">exp</span>(<span class="number">-1</span><span class="built_in">j</span> * w * (M<span class="number">-1</span>) / <span class="number">2</span>);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(w, <span class="built_in">abs</span>(X_dtft))</span><br><span class="line">title(<span class="string">&#x27;DTFT (|X(\omega)|)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x = <span class="built_in">ones</span>(<span class="number">1</span>, M);</span><br><span class="line"></span><br><span class="line"><span class="comment">% P = 8</span></span><br><span class="line">P = <span class="number">8</span>;</span><br><span class="line">X_8pt = fft(x, P);</span><br><span class="line">w_k_8pt = (<span class="number">0</span>:P<span class="number">-1</span>) * (<span class="number">2</span>*<span class="built_in">pi</span>/P);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 16-point dft</span></span><br><span class="line">P = <span class="number">16</span>;</span><br><span class="line">X_16pt = fft(x, P); <span class="comment">% pad 8 point</span></span><br><span class="line">w_k_16pt = (<span class="number">0</span>:P<span class="number">-1</span>) * (<span class="number">2</span>*<span class="built_in">pi</span>/P);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% 32-point dft</span></span><br><span class="line">P = <span class="number">32</span>;</span><br><span class="line">X_32pt = fft(x, P); <span class="comment">% pad 24 point</span></span><br><span class="line">w_k_32pt = (<span class="number">0</span>:P<span class="number">-1</span>) * (<span class="number">2</span>*<span class="built_in">pi</span>/P);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(w, <span class="built_in">abs</span>(X_dtft))</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(w_k_8pt, <span class="built_in">abs</span>(X_8pt), <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;dtft&#x27;</span>, <span class="string">&#x27;8-point dft&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;8-point dft (without zero-padding)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(w, <span class="built_in">abs</span>(X_dtft))</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(w_k_16pt, <span class="built_in">abs</span>(X_16pt), <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;dtft&#x27;</span>, <span class="string">&#x27;16-point dft with 8 point zero-padding&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;16-point dft&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">plot</span>(w, <span class="built_in">abs</span>(X_dtft))</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(w_k_32pt, <span class="built_in">abs</span>(X_32pt), <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;dtft&#x27;</span>, <span class="string">&#x27;32-point dft&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;32-point dft with 24 point zero-padding&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>Zero padding does not improve accuracy or
resolution.</strong></p>
<ul>
<li><p>Zero padding only allows us to look at more samples of that
imperfect reality. It can never reduce the imperfection which caused by
<strong>aliasing</strong>.</p></li>
<li><p>The only way to obtain the detailed signal spectrum with a fine
frequency resolution is to apply more available data samples, that is, a
longer sequence of data.</p></li>
</ul>
<p><img src="/2023/05/27/dtft-dft/image-20230529232357283.png"
alt="image-20230529232357283" /></p>
<p><img src="/2023/05/27/dtft-dft/image-20230529232704566.png"
alt="image-20230529232704566" /></p>
<h3 id="prepend-vs-postpend-vs-both">prepend vs postpend vs both</h3>
<p><em>TODO</em></p>
<h2 id="reference">reference</h2>
<p>Proakis, J. G., &amp; Manolakis, D. G. (2007). Digital signal
processing (4th ed.). Pearson Prentice Hall.</p>
<p>Tan, &amp; Jiang, J. (2019). Digital signal processingâ€¯: fundamentals
and applications / Lizhe Tan and Jean Jiang. (Third edition.). Academic
Press.</p>
<p><a
target="_blank" rel="noopener" href="https://blogs.mathworks.com/steve/2010/03/15/the-dft-and-the-dtft-mathjax/?doing_wp_cron=1648269838.4060609340667724609375">Steve
Eddins, The DFT and the DTFT</a></p>
<p>Lathi, B. P., &amp; Green, R. A. (2018). Linear systems and signals
(Third Edition.). Oxford University Press.</p>
<p>Oppenheim, A. V., &amp; Schafer, R. W. (2014). Discrete-time signal
processing (Third ed., Pearson new internat. ed.). Pearson.</p>
<p>Lyons, R. G. (2011). Understanding digital signal processing (3rd
ed.). Prentice Hall.</p>
<p>Dr. Wang Hongwei. FFT Basics and Case Study using Multi-Instrument
[<a
target="_blank" rel="noopener" href="https://www.virtins.com/doc/D1002/FFT_Basics_and_Case_Study_using_Multi-Instrument_D1002.pdf">pdf</a>]</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/27/dft-window/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/27/dft-window/" class="post-title-link" itemprop="url">Windowing Technique for Accurate DFT</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-27 10:58:53" itemprop="dateCreated datePublished" datetime="2023-05-27T10:58:53+00:00">2023-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-24 16:23:20" itemprop="dateModified" datetime="2023-09-24T16:23:20+00:00">2023-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>leakage</strong>:</p>
<p>â€‹ The component at one frequency leaks into the vicinity of another
compnent owing to the spectral smearing introdued by
<em>window</em>.</p>
<blockquote>
<p>Notice side lobes <em>adding out of phase</em> can <em>reduce</em>
the heights of the peaks</p>
</blockquote>
<h2 id="windowed-signal">Windowed Signal</h2>
<p>Short transient signals in the time domain produce high, broadband
frequency content.</p>
<p><img src="/2023/05/27/dft-window/sharpTransient.png"
alt="sharpTransient" /></p>
<p>To reduce leakage, a mathematical function called a
<strong>window</strong> is applied to the data. Windows are designed to
<em>reduce the sharp transient</em> in the re-created signal as much as
possible.</p>
<p><img src="/2023/05/27/dft-window/windowedsignal.png"
alt="windowedsignal" /></p>
<p>Because the sharp transients are reduced and smoothed, the broadband
frequency of the spectral leakage is also reduced.</p>
<h2 id="periodic-versus-non-periodic-background">Periodic versus
Non-Periodic Background</h2>
<p>When performing a Fourier Transform on measurement data, a window
affects periodic and non-periodic data differently:</p>
<ul>
<li><p><strong>Periodic (No Window needed)</strong>: A signal captured
in a periodic manner does not require a window, and a resulting Fourier
Transform has no leakage. Applying a window alters the resulting Fourier
transform, and even creates spectral leakage where there would have been
no leakage otherwise.</p></li>
<li><p><strong>Non-periodic (Window needed)</strong>: Windows are used
on signals that are captured in a non-periodic manner to reduce spectral
leakage and get closer to the periodic results. A window can minimize
the leakage present in a non-periodic signal, but cannot eliminate
it.</p></li>
</ul>
<blockquote>
<p>The signal is repeated and appended mathematically because the
measured data is assumed to be representative of the entire original
signal</p>
</blockquote>
<h3 id="periodic">Periodic</h3>
<p>When a measurement signal is captured in a periodic manner, the
Fourier Transform of the captured signal will have <strong>no
leakage</strong> in the frequency domain.</p>
<p>A window is not recommended for a periodic signal as it will distort
the signal in an unnecessary manner, and actually creates spectral
leakage.</p>
<p><img src="/2023/05/27/dft-window/captured-periodic.png"
alt="captured-periodic" /></p>
<h3 id="non-periodic">Non-periodic</h3>
<p>The same sine wave, with a different measurement time, results in a
non-periodic captured signal. Here, when the captured signal is
repeated, the original sine wave signal is not re-created.</p>
<p><img src="/2023/05/27/dft-window/captured-nonperiodic.png"
alt="captured-nonperiodic" /></p>
<p>In fact, several broadband transient events (circled in red) are
introduced. These transients create a broadband response, or
<strong>leakage</strong>.</p>
<p><strong>Windows</strong> are used to minimize this leakage effect in
the frequency domain.</p>
<p><img src="/2023/05/27/dft-window/leakage-vs-nonleakage.png"
alt="leakage-vs-nonleakage" /></p>
<h2 id="hanning">Hanning</h2>
<p>When doing operational noise and vibration measurements, the Hanning
window is commonly used.</p>
<p>Random data has spectral leakage due to the <em>abrupt cutoff</em> at
the beginning and end of the time block. It is
<em>non-periodic</em>.</p>
<p>There is <strong>no</strong> way to ensure that the captured random
signal is periodic by varying the measurement time.</p>
<p><strong>Hanning windows</strong> are often used with random data
because they have moderate impact on the frequency resolution and
amplitude accuracy of the resulting frequency spectrum.</p>
<ul>
<li><p>The maximum <em>amplitude error</em> of a Hanning window is
<em>15%</em></p>
<blockquote>
<p>In the cited article, all spectral data <em>had an amplitude
correction factor applied</em>.</p>
</blockquote></li>
<li><p>while the frequency leakage is typically confined to <em>1.5
spectral lines</em> to each side of the original sine wave
signal</p></li>
</ul>
<p><img src="/2023/05/27/dft-window/rtaImage.png"
alt="hanning.png" /></p>
<h3 id="periodic-signal">periodic signal</h3>
<p>Applying the Hanning window (or any window) to a periodic signal
creates <strong>leakage</strong>.</p>
<p><img src="/2023/05/27/dft-window/hanning-periodicsignal.png"
alt="hanning-periodicsignal" /></p>
<blockquote>
<p>The <em>periodically captured</em> sine wave with the Hanning window
(blue) is <em>wider</em> in frequency than the original signal (red)</p>
</blockquote>
<p>In the figure, the sine wave with the Hanning window (blue) is
<em>wider</em> in frequency than the original signal (red).</p>
<h3 id="non-periodic-signal">non-periodic signal</h3>
<p>When a Hanning window is applied to a non-periodic signal, the
leakage is greatly reduced and the amplitude is higher.</p>
<p><img src="/2023/05/27/dft-window/hanning-nonperiodicsignal.png"
alt="hanning-nonperiodicsignal" /></p>
<blockquote>
<p>A <em>non-periodically captured</em> sine wave (magenta) has a
spectral leakage over the entire bandwidth, applying a Hanning window
minimized the leakage (green)</p>
</blockquote>
<h3 id="rms-calculation">RMS calculation</h3>
<p>A <em>RMS calculation</em> <strong>sums up the energy within a
frequency range</strong>.</p>
<p><img src="/2023/05/27/dft-window/rms-cal.png" alt="rms-cal" /></p>
<ul>
<li><p>both the RMS of the periodic and non-periodic signals with a
Hanning window are equal to the RMS of the leakage-free sine
wave.</p></li>
<li><p>Only the RMS of the non-periodic sine wave without a window
applied is not equal to the others</p></li>
</ul>
<blockquote>
<p>With the leakage spread over a smaller frequency range, doing
analysis calculations like <em>RMS</em> yields more accurate
results.</p>
</blockquote>
<h2 id="flattop">Flattop</h2>
<ul>
<li><p>The Flattop window has a <em>better amplitude accuracy</em> in
frequency domain compared to the Hanning window,</p>
<blockquote>
<p>The maximum amplitude error of a Flattop window is <em>less than
0.01%</em>. By contrast, the Hanning window maximum amplitude error is
15%.</p>
</blockquote></li>
<li><p>A Flattop window confines leakage to <em>3.43 spectral lines</em>
to each side of the original signal.</p></li>
</ul>
<h3 id="amplitude-errors">amplitude errors</h3>
<p>These maximum amplitude errors assume that <em>amplitude correction
factors are applied to the frequency spectrums</em>. These amplitude
correction factors compensate for any reduction caused by applying a
window.</p>
<p><img src="/2023/05/27/dft-window/flattop-amplitude.png"
alt="flattop-amplitude" /></p>
<h3 id="leakage">leakage</h3>
<p>The frequency accuracy of the Flattop window is more coarse compared
to a Hanning window. As a result, the Flattop window is typically
employed on data where frequency peaks are distinct and well separated
from each other.</p>
<p><img src="/2023/05/27/dft-window/flattop-leakage.png"
alt="flattop-leakage" /></p>
<p>When the frequency peaks are not guaranteed to be well separated, the
Hanning window is preferred because it is less likely to cause
individual peaks to be lost in the spectrum</p>
<p><img src="/2023/05/27/dft-window/flattop-2tone.png"
alt="flattop-2tone" /></p>
<p>Spectrum of two periodically captured tones that are <span
class="math inline">\(4Hz\)</span> apart with a <span
class="math inline">\(1Hz\)</span> frequency resolution. The spectrum
with a Hanning window (green) shows two peaks while the spectrum with a
Flattop window (blue) shows one peak.</p>
<blockquote>
<p>Note that at the original frequencies of the tones the amplitude is
correct and equal to one for both windows.</p>
</blockquote>
<blockquote>
<p>One common application for a flattop window is performing
<em>calibration</em>. For example, a sound pistonphone only produces
<em>one single</em> and <em>distinct frequency</em> during microphone
calibration.</p>
</blockquote>
<h2 id="uniform">Uniform</h2>
<p>A Uniform window has a value of <em>1.0</em> across the entire
measurement time. In reality, a <strong>Uniform window</strong> could be
called <strong>no window</strong>.</p>
<blockquote>
<p>Depending on the data acquisition system used, sometimes the term
<strong>Rectangular</strong> window is also used.</p>
</blockquote>
<ul>
<li><p>A Uniform window creates no frequency or amplitude distortion
when the measured signal is periodic.</p></li>
<li><p>When a measured signal is not periodic, the amplitude is reduced
by a maximum of <em>36%</em> and the frequency content is spread over
the <em>entire bandwidth of the measurement</em>.</p>
<blockquote>
<p>This is due to <em>sharp transients</em> that are created by
repeating and appending the measured signal.</p>
</blockquote></li>
</ul>
<blockquote>
<p>Whenever a measurement signal is periodic, a Uniform window is
preferred.</p>
<p>Applying a Hanning or Flattop window to a periodic signal will
actually create amplitude and frequency distortion.</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/uniformwindow.png"
alt="uniformwindow" /></p>
<h2 id="benefit-of-reducing-leakage">Benefit of Reducing Leakage</h2>
<p>The benefit is <strong>not</strong> that the captured signal is
perfectly replicated.</p>
<p><strong>The main benefit is that the leakage is now confined over a
smaller frequency range</strong>, instead of affecting the entire
frequency bandwidth of the measurement.</p>
<blockquote>
<p>With the leakage spread over a smaller frequency range, doing
analysis calculations like RMS yields more accurate results.</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/rms-windowed.png"
alt="rms-windowed" /></p>
<p>It is impossible to calculate the proper RMS amplitude estimate over
a limited frequency range of the <em>un-windowed sine wave</em>, since
the leakage is <em>over the full frequency range</em>. Therefore the RMS
amplitude is not correct.</p>
<h3 id="two-tones">Two tones</h3>
<p>In the case of two closely spaced sine tones, without a window being
applied, two tones frequencies would leak into each other, which make
determining the true amplitude of individual peaks very difficult.</p>
<p>The window makes it easier to separate and distinguish each tone so a
proper analysis could be performed.</p>
<p><img src="/2023/05/27/dft-window/windowed-2tone.png"
alt="windowed-2tone" /></p>
<h2 id="the-window-function-in-the-frequency-domain">The window function
in the frequency domain</h2>
<p>The transfer function <span class="math inline">\(a(f)\)</span> of a
window <span class="math inline">\(w_j, j \in [0, N-1]\)</span>
expresses the response of the window to a sinusoidal signal at an offset
of <span class="math inline">\(f\)</span> frequency bins, i.e. DFT .</p>
<p><strong>real part:</strong> <span class="math display">\[
a_r(f)=\sum_{j=0}^{N-1}w_j\cos (2\pi f j/N)
\]</span></p>
<p><strong>imaginary part:</strong> <span class="math display">\[
a_i(f)=\sum_{j=0}^{N-1}w_j\sin (2\pi f j/N)
\]</span></p>
<p>frequency response can be obtained as <span class="math display">\[
a(f) = \frac{\sqrt{a_r^2+a_i^2}}{S_1}
\]</span> where <span class="math inline">\(S_1 = \sum
_{k=0}^{N-1}w_k\)</span></p>
<h2 id="properties-of-the-windows">Properties of the Windows</h2>
<p>There is <strong>no</strong> possibility of trade-off between
<em>main-lobe width</em> and <em>sied-lobe amplitude</em>, since the
<em>window length</em> is the only variable parameter.</p>
<blockquote>
<p>The rectangular window has the narrowest main lobe for a given
length, i.e. <span class="math inline">\(\Delta
_{ml}=4\pi/L\)</span></p>
<p>Other windows include the Bartlett, Hann, and Hamming windows. The
DTFTs of all these windows have main-lobe width <span
class="math inline">\(\Delta _{ml}=8\pi/(L-1)\)</span>, which is
approximately twice that of the rectangular window, but they have
significantly smaller side-lobe amplitudes.</p>
</blockquote>
<h2 id="demo">Demo</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">clc;</span><br><span class="line">clear all;</span><br><span class="line"></span><br><span class="line">N = <span class="number">512</span>;</span><br><span class="line">fs = <span class="number">40</span>*<span class="number">1e3</span>; <span class="comment">% 40kHz</span></span><br><span class="line">fres = fs/N; <span class="comment">% 78.125</span></span><br><span class="line">tt = (<span class="number">0</span>:N<span class="number">-1</span>)*<span class="number">1</span>/fs;</span><br><span class="line">ff = (<span class="number">0</span>:N/<span class="number">2</span>)*fres;</span><br><span class="line">fin = <span class="number">390.625</span>;</span><br><span class="line"></span><br><span class="line">whan = hanning(N); <span class="comment">% hanning window</span></span><br><span class="line">wrect = rectwin(N); <span class="comment">% rect window</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin/fs = 5/N, periodically captured sine wave</span></span><br><span class="line">wv = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin*tt);</span><br><span class="line">power = periodogram(wv, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X = (power).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd = periodogram(wv, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms = sum(psd*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@periodic &amp; hanning: %.5f\n&#x27;</span>, rms);</span><br><span class="line"></span><br><span class="line">power_rect = periodogram(wv, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_rect = (power_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_rect = periodogram(wv, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_rect = sum(psd_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@periodic &amp; rect: %.5f\n&#x27;</span>, rms_rect);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X, <span class="string">&#x27;r-o&#x27;</span>, ff, X_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of periodically captured sine wave&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% rectangular window provide higher frequency resolution</span></span><br><span class="line"><span class="comment">% hanning window induce leakage for the periodically captured sine wave</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin - 0.5fres</span></span><br><span class="line">fin_lkg0d5 = fin - <span class="number">0.5</span>*fres;</span><br><span class="line">wv_lkg0d5 = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin_lkg0d5*tt);</span><br><span class="line">power_lkg0d5 = periodogram(wv_lkg0d5, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d5 = (power_lkg0d5).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d5 = periodogram(wv_lkg0d5, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d5 = sum(psd_lkg0d5*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.5fres &amp; hanning: %.5f\n&#x27;</span>, rms_lkg0d5);</span><br><span class="line"></span><br><span class="line">power_lkg0d5_rect = periodogram(wv_lkg0d5, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d5_rect = (power_lkg0d5_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d5_rect = periodogram(wv_lkg0d5, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d5_rect = sum(psd_lkg0d5_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.5fres &amp; rect: %.5f\n&#x27;</span>, rms_lkg0d5_rect);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X_lkg0d5, <span class="string">&#x27;r-o&#x27;</span>, ff, X_lkg0d5_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of -0.5fres&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% hanning reduce leakage and max amplitude error 15%</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin - 0.25fres</span></span><br><span class="line">fin_lkg0d25 = fin - <span class="number">0.25</span>*fres;</span><br><span class="line">wv_lkg0d25 = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin_lkg0d25*tt);</span><br><span class="line">power_lkg0d25 = periodogram(wv_lkg0d25, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d25 = (power_lkg0d25).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d25 = periodogram(wv_lkg0d25, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d25 = sum(psd_lkg0d25*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.25fres &amp; hanning: %.5f\n&#x27;</span>, rms_lkg0d25);</span><br><span class="line"></span><br><span class="line">power_lkg0d25_rect = periodogram(wv_lkg0d25, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d25_rect = (power_lkg0d25_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d25_rect = periodogram(wv_lkg0d25, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d25_rect = sum(psd_lkg0d25_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.25fres &amp; rect: %.5f\n&#x27;</span>, rms_lkg0d25_rect);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X_lkg0d25, <span class="string">&#x27;r-o&#x27;</span>, ff, X_lkg0d25_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of -0.25fres&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% hanning reduce leakage</span></span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RMS@periodic &amp; hanning: 0.70711</span><br><span class="line">RMS@periodic &amp; rect: 0.70711</span><br><span class="line">RMS@-0.5fres &amp; hanning: 0.70711</span><br><span class="line">RMS@-0.5fres &amp; rect: 0.70711</span><br><span class="line">RMS@-0.25fres &amp; hanning: 0.70711</span><br><span class="line">RMS@-0.25fres &amp; rect: 0.70780</span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/27/dft-window/image-20230526005823613.png"
alt="image-20230526005823613" /></p>
<blockquote>
<p>rectangular window provide higher frequency resolution</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/image-20230526005934411.png"
alt="image-20230526005934411" /></p>
<blockquote>
<p>hanning reduce leakage and max amplitude error 15%</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/image-20230526010047826.png"
alt="image-20230526010047826" /></p>
<blockquote>
<p>hanning reduce leakage and reduce amplitude error</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Article (20416822) Title: How to Utilize a Windowing Technique for
Accurate DFT URL: <a
target="_blank" rel="noopener" href="https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1Od000000050UrEAI">https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1Od000000050UrEAI</a></p>
<p>B.P. Lathi, Roger Green. Linear Systems and Signals (The Oxford
Series in Electrical and Computer Engineering) 3rd Edition</p>
<p>Window Types: Hanning, Flattop, Uniform, Tukey, and Exponential
URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/window-types-hanning-flattop-uniform-tukey-and-exponential">https://community.sw.siemens.com/s/article/window-types-hanning-flattop-uniform-tukey-and-exponential</a></p>
<p>Window Correction Factors URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/window-correction-factors">https://community.sw.siemens.com/s/article/window-correction-factors</a></p>
<p>Root Mean Square (RMS) and Overall Level. URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/root-mean-square-rms-and-overall-level">https://community.sw.siemens.com/s/article/root-mean-square-rms-and-overall-level</a></p>
<p>Windows and Spectral Leakage. URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/windows-and-spectral-leakage">https://community.sw.siemens.com/s/article/windows-and-spectral-leakage</a></p>
<p>Alan V Oppenheim, Ronald W. Schafer. Discrete-Time Signal Processing,
3rd edition</p>
<p>Stefan Scholl, "Exact Signal Measurements using FFT
Analysis",Microelectronic Systems Design Research Group, TU
Kaiserslautern, Germany. [ <a
target="_blank" rel="noopener" href="https://kluedo.ub.rptu.de/frontdoor/deliver/index/docId/4293/file/exact_fft_measurements.pdf">pdf</a>
]</p>
<p>Harris, F. (1978). On the use of windows for harmonic analysis with
the discrete Fourier transform. Proceedings of the IEEE, 66, 51-83. [<a
target="_blank" rel="noopener" href="https://www.fceia.unr.edu.ar/prodivoz/Harris_1978.pdf">pdf</a>]</p>
<p>Equivalent noise bandwidth (ENBW) of window functions URL:<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2020/09/equivalent-noise-bandwidth-enbw-of-window-functions/">https://www.gaussianwaves.com/2020/09/equivalent-noise-bandwidth-enbw-of-window-functions/</a></p>
<p>Why should I zero-pad a signal before taking the Fourier transform?
URL:<a
target="_blank" rel="noopener" href="https://dsp.stackexchange.com/q/741">https://dsp.stackexchange.com/q/741</a></p>
<p>enbw function in MATLAB URL:<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ref/enbw.html">https://www.mathworks.com/help/signal/ref/enbw.html</a></p>
<p>Window function â€“ figure of merits URL:<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2020/09/window-function-figure-of-merits/">https://www.gaussianwaves.com/2020/09/window-function-figure-of-merits/</a></p>
<p>Memos on FFT With Windowing URL:<a
target="_blank" rel="noopener" href="https://everynanocounts.com/2018/02/01/memos-on-fft-with-windowing/">https://everynanocounts.com/2018/02/01/memos-on-fft-with-windowing/</a></p>
<p>Jens Ahrens, "Some Notes on Windows in Spectral Analysis," Tech.
Report, Chalmers Univeristy of Technology, 2020. URL:<a
target="_blank" rel="noopener" href="https://appliedacousticschalmers.github.io/scaling-of-the-dft/notes_on_windows/">https://appliedacousticschalmers.github.io/scaling-of-the-dft/notes_on_windows/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Guo</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.2.12/pdfobject.min.js","integrity":"sha256-g2xji1rlE3KsGVClvuxTbcR0Kn2+wtQADSff2Tbb4zA="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
